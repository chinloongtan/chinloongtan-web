<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/assets/favicon.png"/><meta name="keywords" content="react native, experienced, developer"/><title>Chin Loong Tan - Going offline with Realm database</title><meta name="title" content="Chin Loong Tan - Going offline with Realm database"/><meta name="description" content="A different approach"/><meta name="next-head-count" content="10"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/aa41812dda2461f4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aa41812dda2461f4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-67152b7131474bdd.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-292e4726b4fd03ef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fcb6ce8b52eb27db.js" defer=""></script><script src="/_next/static/chunks/b2e984c5-52c564665cb02377.js" defer=""></script><script src="/_next/static/chunks/601-597bb24ff23733d9.js" defer=""></script><script src="/_next/static/chunks/675-7b1b173673ee7f53.js" defer=""></script><script src="/_next/static/chunks/518-ca43922f1257f114.js" defer=""></script><script src="/_next/static/chunks/822-db57bad4b081872d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-aec22527f36ee821.js" defer=""></script><script src="/_next/static/qhS5udue7bFNQhItJQYrR/_buildManifest.js" defer=""></script><script src="/_next/static/qhS5udue7bFNQhItJQYrR/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css?family=Raleway:400,500,700&display=swap">@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pbCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="blog-post-container content"><nav class="bg-white fixed top-0 left-0 w-full shadow flex items-center z-50" style="height:64px"><div class="relative flex-1 flex"><button type="button" class="p-4"><svg viewBox="0 0 24 24" style="width:1.5rem;height:1.5rem" role="presentation"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" style="fill:currentColor"></path></svg></button><div class="flex flex-1 text-xl font-medium items-center"><a href="/blog" class="">BLOG</a></div></div><div class="hidden md:hidden absolute bg-white w-full" style="top:64px"><a href="https://mvphub.app/" target="_blank" class="px-4 py-2 block">SHOP</a><a href="/blog" target="_self" class="px-4 py-2 block">BLOG</a><a href="/about" target="_self" class="px-4 py-2 block">ABOUT</a></div></nav><div class="p-4 md:px-16 md:py-8 lg:px-32"><h2 class="font-bold text-2xl">Going offline with Realm database</h2><h6 class="text-md" style="color:#576366">5 October 2018</h6><h6 class="text-lg" style="color:#576366">A different approach</h6><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(245, 89, 94, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#f5595e" class="font-medium" href="/tags/realm-db/">realm-db<!-- --> </a><a style="margin-right:10px;background-color:rgba(160, 71, 217, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#a047d9" class="font-medium" href="/tags/offline-first/">offline-first<!-- --> </a></div><hr class="my-8"/><div class="prose lg:prose-xl"><p>I published an app.</p>
<p>As a first version, it allows users(mostly me) to check for train schedule in the app.</p>
<p>It looks like this, as of current writing of this blog.</p>
<p><img alt="app_screenshot" node="[object Object]" post="[object Object]" loading="lazy" width="230" height="409" decoding="async" data-nimg="1" style="color:transparent;width:100%;height:auto;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http%3A//www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 4 8&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;1&#x27;/%3E%3CfeComponentTransfer%3E%3CfeFuncA type=&#x27;discrete&#x27; tableValues=&#x27;1 1&#x27;/%3E%3C/feComponentTransfer%3E%%3C/filter%3E%3Cimage preserveAspectRatio=&#x27;none&#x27; filter=&#x27;url(%23b)&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; height=&#x27;100%25&#x27; width=&#x27;100%25&#x27; href=&#x27;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgABAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABgEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAL4R/8QAGRAAAQUAAAAAAAAAAAAAAAAAAAQGFlWS/9oACAEBAAE/AIm2KRJk/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwB//8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAwEBPwB//9k=&#x27;/%3E%3C/svg%3E&quot;)" src="/_next/static/media/blog_screenshot.d6714588.jpeg"/></p>
<br/>
<h4>API - The initial approach</h4>
<p>Well, it is a straight forward app, get the following from user selection:</p>
<ul>
<li>origin station</li>
<li>destination station</li>
</ul>
<p>Then compute the upcoming train and display the time.</p>
<p>Withtout much thought, I created a few APIs, plugged it to the app and start displaying data.</p>
<p>Everything was fine.</p>
<p>Until when I am setting up for production environment, I realized I couldn&#x27;t utilize the free tier of Amazon Web Services anymore(expired soon).</p>
<p>I made a quick look up on AWS cost calculator, and roughly have idea what it means for setting up the production server(financially).</p>
<p>For an app I always wanted to build, for me and my friends&#x27; own convenience(I used to always missed the last train), it is going to be ongoing cost as long as it runs.</p>
<p>Since the app is not going to make enough revenue to cover it&#x27;s own cost of running, I needed an alternative.</p>
<br/>
<hr/>
<br/>
<h4>Enter offline app</h4>
<p>I paused the development and thought about the alternatives for a bit.</p>
<p>It became obvious to me that the app just need access to the database of timetables, routes, and stations in order to work.</p>
<p>And if I can have all those data in the device, I don&#x27;t need API for that.</p>
<p>So the idea is to use a database in the app, serve the data from it, and let it work offline.</p>
<p>And this approach does provide a few benefits.</p>
<ul>
<li>Zero cost for maintaining server</li>
<li>No backend work required (API, database, devops)</li>
<li>I can use the app offline</li>
</ul>
<br/>
<hr/>
<br/>
<h4>Realm database in action</h4>
<p>Why realm db?</p>
<p>Well it&#x27;s mainly because of the support for react-native app out of the box.</p>
<p>It is well documented, offline-first(as promoted), full-fledged mobile database and is performant, have open source version, and the list goes on.</p>
<p>Why not redux-persist?</p>
<p>We are talking about 3000+ objects to be stored and accessed, and I think it is not a good idea to use redux-persist in this case (after browsing through their Github issues and quick research for the suitable tools).</p>
<p>Turns out to be a good choice for the work.</p>
<p>With a major roadblock before publishing the app, but is solved.</p>
<br/>
<h5>Database initializing time</h5>
<p>So it took about 24 seconds to initialize a realm db to load all the schema and their respective seed data I needed for the app.</p>
<p>I have a splash screen shown while initializing it, but it&#x27;s just too long to wait.</p>
<p>So in a hurry to publish the app as soon as possible (as I did it during a weekend, and weekday will be busy for other works), this is something that will potentially stop the desire to publish the app before the weekday comes.</p>
<p>It is as if there is only me is having the issue and after revising the documentation over and over again, there is an alternative.</p>
<p>What we can do in this case is, we can let Realm to read from existing database and use it.</p>
<p>Perfect!</p>
<p>So I have a copy of the initialized database(basically a <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.realm</code> file), direct it to Realm when opening database and that&#x27;s it!</p>
<p>We don&#x27;t have to seed the data everytime the app launches! The data is ready to be used.</p>
<br/>
<p>Now the app started working offline, and it is just the beginning of offline-first app journey.</p></div></div><footer class="p-4 md:p-8 lg:p-16"><div class=""><h4 class="text-xl mb-4">Contact me via:</h4><a href="https://www.linkedin.com/in/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z" style="fill:currentColor"></path></svg></div>chinloongtan</a><div class="" style="margin-bottom:0;color:white"><a href="mailto:me@chinloongtan.com?body=Hi Chin Loong,
" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M22 6C22 4.9 21.1 4 20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6M20 6L12 11L4 6H20M20 18H4V8L12 13L20 8V18Z" style="fill:currentColor"></path></svg></div>me@chinloongtan.com</a></div></div><div class="mt-6 md:mt-16"><h4 class="text-xl mb-4">Or Buy Me A Coffee:</h4><a href="https://www.buymeacoffee.com/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M2,21V19H20V21H2M20,8V5H18V8H20M20,3A2,2 0 0,1 22,5V8A2,2 0 0,1 20,10H18V13A4,4 0 0,1 14,17H8A4,4 0 0,1 4,13V3H20M16,5H6V13A2,2 0 0,0 8,15H14A2,2 0 0,0 16,13V5Z" style="fill:currentColor"></path></svg></div>chinloongtan</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"content":"\nI published an app.\n\nAs a first version, it allows users(mostly me) to check for train schedule in the app.\n\nIt looks like this, as of current writing of this blog.\n\n![app_screenshot](blog_screenshot.jpeg)\n\n\u003cbr /\u003e\n\n#### API - The initial approach\n\nWell, it is a straight forward app, get the following from user selection:\n- origin station\n- destination station\n\nThen compute the upcoming train and display the time.\n\nWithtout much thought, I created a few APIs, plugged it to the app and start displaying data.\n\nEverything was fine.\n\nUntil when I am setting up for production environment, I realized I couldn't utilize the free tier of Amazon Web Services anymore(expired soon).\n\nI made a quick look up on AWS cost calculator, and roughly have idea what it means for setting up the production server(financially).\n\nFor an app I always wanted to build, for me and my friends' own convenience(I used to always missed the last train), it is going to be ongoing cost as long as it runs.\n\nSince the app is not going to make enough revenue to cover it's own cost of running, I needed an alternative.\n\n\u003cbr /\u003e\n\u003chr /\u003e\n\u003cbr /\u003e\n\n#### Enter offline app\n\nI paused the development and thought about the alternatives for a bit.\n\nIt became obvious to me that the app just need access to the database of timetables, routes, and stations in order to work.\n\nAnd if I can have all those data in the device, I don't need API for that.\n\nSo the idea is to use a database in the app, serve the data from it, and let it work offline.\n\nAnd this approach does provide a few benefits.\n\n- Zero cost for maintaining server\n- No backend work required (API, database, devops)\n- I can use the app offline\n\n\u003cbr /\u003e\n\u003chr /\u003e\n\u003cbr /\u003e\n\n#### Realm database in action\n\nWhy realm db?\n\nWell it's mainly because of the support for react-native app out of the box.\n\nIt is well documented, offline-first(as promoted), full-fledged mobile database and is performant, have open source version, and the list goes on.\n\nWhy not redux-persist?\n\nWe are talking about 3000+ objects to be stored and accessed, and I think it is not a good idea to use redux-persist in this case (after browsing through their Github issues and quick research for the suitable tools).\n\nTurns out to be a good choice for the work.\n\nWith a major roadblock before publishing the app, but is solved.\n\n\u003cbr /\u003e\n\n##### Database initializing time\n\nSo it took about 24 seconds to initialize a realm db to load all the schema and their respective seed data I needed for the app.\n\nI have a splash screen shown while initializing it, but it's just too long to wait.\n\n\nSo in a hurry to publish the app as soon as possible (as I did it during a weekend, and weekday will be busy for other works), this is something that will potentially stop the desire to publish the app before the weekday comes.\n\nIt is as if there is only me is having the issue and after revising the documentation over and over again, there is an alternative.\n\nWhat we can do in this case is, we can let Realm to read from existing database and use it.\n\nPerfect!\n\nSo I have a copy of the initialized database(basically a `.realm` file), direct it to Realm when opening database and that's it!\n\nWe don't have to seed the data everytime the app launches! The data is ready to be used.\n\n\u003cbr /\u003e\n\nNow the app started working offline, and it is just the beginning of offline-first app journey.\n","frontmatter":{"path":"/blog/offline-app-with-realm-db","date":"2018-10-04T19:14:00.962Z","title":"Going offline with Realm database","excerpt":"A different approach","tags":["realm-db","offline-first"]},"fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2018/10/04-offline-app-with-realm-db/index.md","timeToRead":3}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"offline-app-with-realm-db"},"buildId":"qhS5udue7bFNQhItJQYrR","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>