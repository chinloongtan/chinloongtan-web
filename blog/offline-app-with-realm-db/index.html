<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/><link rel="shortcut icon" href="/assets/favicon.png"/><meta name="keywords" content="react native, experienced, developer"/><title>Chin Loong Tan - Going offline with Realm database</title><meta name="title" content="Chin Loong Tan - Going offline with Realm database"/><meta name="description" content="A different approach"/><meta name="next-head-count" content="10"/><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/8ab0e2f413d160a8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8ab0e2f413d160a8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-36d12a75f0098f30.js" defer=""></script><script src="/_next/static/chunks/framework-36098b990598bc0c.js" defer=""></script><script src="/_next/static/chunks/main-a3243aca410ca0a4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1f9dfc3098bb9772.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4d59f40a6e1b3add.js" defer=""></script><script src="/_next/static/chunks/143-9ff2fc886054cfbb.js" defer=""></script><script src="/_next/static/chunks/674-34b4b08e45e656fc.js" defer=""></script><script src="/_next/static/chunks/767-0180798ec2644e62.js" defer=""></script><script src="/_next/static/chunks/675-e08c64594a2462bd.js" defer=""></script><script src="/_next/static/chunks/993-684785ffadc436d4.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-1e90c9b369a5176e.js" defer=""></script><script src="/_next/static/X5_h3X55JoY-u1eywSZ45/_buildManifest.js" defer=""></script><script src="/_next/static/X5_h3X55JoY-u1eywSZ45/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css?family=Raleway:400,500,700">@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pbCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="blog-post-container content"><div class="custom-nav"><style data-emotion="css k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="MuiBox-root css-k008qs"><style data-emotion="css 13x2oq7">.css-13x2oq7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-13x2oq7{position:absolute;}}</style><style data-emotion="css 5poeop">.css-5poeop{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-5poeop{position:absolute;}}</style><nav class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-5poeop" style="background-color:white"><style data-emotion="css i6s8oy">.css-i6s8oy{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;}@media (min-width:600px){.css-i6s8oy{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-i6s8oy{min-height:48px;}}}@media (min-width:600px){.css-i6s8oy{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-i6s8oy"><a href="/blog/"><style data-emotion="css er9axy">.css-er9axy{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:black;}.css-er9axy:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-er9axy:hover{background-color:transparent;}}.css-er9axy.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css zo9a81">.css-zo9a81{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:black;}.css-zo9a81::-moz-focus-inner{border-style:none;}.css-zo9a81.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-zo9a81{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-zo9a81:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-zo9a81:hover{background-color:transparent;}}.css-zo9a81.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-edgeStart MuiIconButton-sizeMedium css-zo9a81" tabindex="0" type="button" aria-label="back"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ArrowBackIcon"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg></button></a><style data-emotion="css 13ge1hf">.css-13ge1hf{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}@media (min-width:600px){.css-13ge1hf{display:block;}}</style><div class="MuiTypography-root MuiTypography-h6 css-13ge1hf"><a style="color:black;font-family:Raleway;text-decoration:none" class="" href="/blog/">BLOG</a></div></div></nav><nav class="MuiBox-root css-0"><style data-emotion="css 12acf6p">.css-12acf6p{z-index:1200;}@media (min-width:0px){.css-12acf6p{display:block;}}@media (min-width:600px){.css-12acf6p{display:none;}}.css-12acf6p .MuiDrawer-paper{box-sizing:border-box;width:240px;}</style></nav></div></div><div class="p-4 md:px-16 md:py-8 lg:px-32"><h2 class="font-bold text-2xl">Going offline with Realm database</h2><h6 class="text-md" style="color:#576366">October 04, 2018</h6><h6 class="text-lg" style="color:#576366">A different approach</h6><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(245, 89, 94, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#f5595e" class="font-medium" href="/tags/realm-db/">realm-db<!-- --> </a><a style="margin-right:10px;background-color:rgba(160, 71, 217, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#a047d9" class="font-medium" href="/tags/offline-first/">offline-first<!-- --> </a></div><hr class="my-8"/><div class="prose lg:prose-xl"><p>I published an app.</p>
<p>As a first version, it allows users(mostly me) to check for train schedule in the app.</p>
<p>It looks like this, as of current writing of this blog.</p>
<p><img alt="app_screenshot" node="[object Object]" post="[object Object]" src="/_next/static/media/blog_screenshot.d6714588.jpeg" width="230" height="409" decoding="async" data-nimg="1" loading="lazy" style="color:transparent;width:100%;height:auto;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http%3A//www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 4 8&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;1&#x27;/%3E%3CfeComponentTransfer%3E%3CfeFuncA type=&#x27;discrete&#x27; tableValues=&#x27;1 1&#x27;/%3E%3C/feComponentTransfer%3E%%3C/filter%3E%3Cimage preserveAspectRatio=&#x27;none&#x27; filter=&#x27;url(%23b)&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; height=&#x27;100%25&#x27; width=&#x27;100%25&#x27; href=&#x27;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgABAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABgEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAL4R/8QAGRAAAQUAAAAAAAAAAAAAAAAAAAQGFlWS/9oACAEBAAE/AIm2KRJk/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwB//8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAwEBPwB//9k=&#x27;/%3E%3C/svg%3E&quot;)"/></p>
<br/>
<h4>API - The initial approach</h4>
<p>Well, it is a straight forward app, get the following from user selection:</p>
<ul>
<li>origin station</li>
<li>destination station</li>
</ul>
<p>Then compute the upcoming train and display the time.</p>
<p>Withtout much thought, I created a few APIs, plugged it to the app and start displaying data.</p>
<p>Everything was fine.</p>
<p>Until when I am setting up for production environment, I realized I couldn&#x27;t utilize the free tier of Amazon Web Services anymore(expired soon).</p>
<p>I made a quick look up on AWS cost calculator, and roughly have idea what it means for setting up the production server(financially).</p>
<p>For an app I always wanted to build, for me and my friends&#x27; own convenience(I used to always missed the last train), it is going to be ongoing cost as long as it runs.</p>
<p>Since the app is not going to make enough revenue to cover it&#x27;s own cost of running, I needed an alternative.</p>
<br/>
<hr/>
<br/>
<h4>Enter offline app</h4>
<p>I paused the development and thought about the alternatives for a bit.</p>
<p>It became obvious to me that the app just need access to the database of timetables, routes, and stations in order to work.</p>
<p>And if I can have all those data in the device, I don&#x27;t need API for that.</p>
<p>So the idea is to use a database in the app, serve the data from it, and let it work offline.</p>
<p>And this approach does provide a few benefits.</p>
<ul>
<li>Zero cost for maintaining server</li>
<li>No backend work required (API, database, devops)</li>
<li>I can use the app offline</li>
</ul>
<br/>
<hr/>
<br/>
<h4>Realm database in action</h4>
<p>Why realm db?</p>
<p>Well it&#x27;s mainly because of the support for react-native app out of the box.</p>
<p>It is well documented, offline-first(as promoted), full-fledged mobile database and is performant, have open source version, and the list goes on.</p>
<p>Why not redux-persist?</p>
<p>We are talking about 3000+ objects to be stored and accessed, and I think it is not a good idea to use redux-persist in this case (after browsing through their Github issues and quick research for the suitable tools).</p>
<p>Turns out to be a good choice for the work.</p>
<p>With a major roadblock before publishing the app, but is solved.</p>
<br/>
<h5>Database initializing time</h5>
<p>So it took about 24 seconds to initialize a realm db to load all the schema and their respective seed data I needed for the app.</p>
<p>I have a splash screen shown while initializing it, but it&#x27;s just too long to wait.</p>
<p>So in a hurry to publish the app as soon as possible (as I did it during a weekend, and weekday will be busy for other works), this is something that will potentially stop the desire to publish the app before the weekday comes.</p>
<p>It is as if there is only me is having the issue and after revising the documentation over and over again, there is an alternative.</p>
<p>What we can do in this case is, we can let Realm to read from existing database and use it.</p>
<p>Perfect!</p>
<p>So I have a copy of the initialized database(basically a <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.realm</code> file), direct it to Realm when opening database and that&#x27;s it!</p>
<p>We don&#x27;t have to seed the data everytime the app launches! The data is ready to be used.</p>
<br/>
<p>Now the app started working offline, and it is just the beginning of offline-first app journey.</p></div></div><footer class="p-4 md:p-8 lg:p-16"><div class=""><h4 class="text-xl mb-4">Contact me via:</h4><a href="https://www.linkedin.com/in/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><span style="width:45px;font-size:35px;color:white" aria-hidden="true" class="fa fa-linkedin-square"></span>chinloongtan</a><div class="" style="margin-bottom:0;color:white"><a href="mailto:me@chinloongtan.com?body=Hi Chin Loong,
" style="color:white" class="flex items-center"><span style="width:45px;font-size:30px;color:white;margin-top:15px;margin-bottom:15px" aria-hidden="true" class="fa fa-envelope-open-o"></span>me@chinloongtan.com</a></div></div><div class="mt-6 md:mt-16"><h4 class="text-xl mb-4">Or Buy Me A Coffee:</h4><a href="https://www.buymeacoffee.com/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><span style="width:45px;font-size:30px;color:white" aria-hidden="true" class="fa fa-coffee"></span>chinloongtan</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"content":"\nI published an app.\n\nAs a first version, it allows users(mostly me) to check for train schedule in the app.\n\nIt looks like this, as of current writing of this blog.\n\n![app_screenshot](blog_screenshot.jpeg)\n\n\u003cbr /\u003e\n\n#### API - The initial approach\n\nWell, it is a straight forward app, get the following from user selection:\n- origin station\n- destination station\n\nThen compute the upcoming train and display the time.\n\nWithtout much thought, I created a few APIs, plugged it to the app and start displaying data.\n\nEverything was fine.\n\nUntil when I am setting up for production environment, I realized I couldn't utilize the free tier of Amazon Web Services anymore(expired soon).\n\nI made a quick look up on AWS cost calculator, and roughly have idea what it means for setting up the production server(financially).\n\nFor an app I always wanted to build, for me and my friends' own convenience(I used to always missed the last train), it is going to be ongoing cost as long as it runs.\n\nSince the app is not going to make enough revenue to cover it's own cost of running, I needed an alternative.\n\n\u003cbr /\u003e\n\u003chr /\u003e\n\u003cbr /\u003e\n\n#### Enter offline app\n\nI paused the development and thought about the alternatives for a bit.\n\nIt became obvious to me that the app just need access to the database of timetables, routes, and stations in order to work.\n\nAnd if I can have all those data in the device, I don't need API for that.\n\nSo the idea is to use a database in the app, serve the data from it, and let it work offline.\n\nAnd this approach does provide a few benefits.\n\n- Zero cost for maintaining server\n- No backend work required (API, database, devops)\n- I can use the app offline\n\n\u003cbr /\u003e\n\u003chr /\u003e\n\u003cbr /\u003e\n\n#### Realm database in action\n\nWhy realm db?\n\nWell it's mainly because of the support for react-native app out of the box.\n\nIt is well documented, offline-first(as promoted), full-fledged mobile database and is performant, have open source version, and the list goes on.\n\nWhy not redux-persist?\n\nWe are talking about 3000+ objects to be stored and accessed, and I think it is not a good idea to use redux-persist in this case (after browsing through their Github issues and quick research for the suitable tools).\n\nTurns out to be a good choice for the work.\n\nWith a major roadblock before publishing the app, but is solved.\n\n\u003cbr /\u003e\n\n##### Database initializing time\n\nSo it took about 24 seconds to initialize a realm db to load all the schema and their respective seed data I needed for the app.\n\nI have a splash screen shown while initializing it, but it's just too long to wait.\n\n\nSo in a hurry to publish the app as soon as possible (as I did it during a weekend, and weekday will be busy for other works), this is something that will potentially stop the desire to publish the app before the weekday comes.\n\nIt is as if there is only me is having the issue and after revising the documentation over and over again, there is an alternative.\n\nWhat we can do in this case is, we can let Realm to read from existing database and use it.\n\nPerfect!\n\nSo I have a copy of the initialized database(basically a `.realm` file), direct it to Realm when opening database and that's it!\n\nWe don't have to seed the data everytime the app launches! The data is ready to be used.\n\n\u003cbr /\u003e\n\nNow the app started working offline, and it is just the beginning of offline-first app journey.\n","frontmatter":{"path":"/blog/offline-app-with-realm-db","date":"2018-10-04T19:14:00.962Z","title":"Going offline with Realm database","excerpt":"A different approach","tags":["realm-db","offline-first"]},"fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2018/10/04-offline-app-with-realm-db/index.md","timeToRead":3}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"offline-app-with-realm-db"},"buildId":"X5_h3X55JoY-u1eywSZ45","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>