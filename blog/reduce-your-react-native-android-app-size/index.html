<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/assets/favicon.png"/><meta name="keywords" content="react native, experienced, developer"/><title>Chin Loong Tan - Reduce your react-native android app size</title><meta name="title" content="Chin Loong Tan - Reduce your react-native android app size"/><meta name="description" content="By 55% with android app bundle (.aab)"/><meta name="next-head-count" content="10"/><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/f76ff1bfed0d901a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f76ff1bfed0d901a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3a40dd1c3cc78000.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-292e4726b4fd03ef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6abf4d54e290bf3b.js" defer=""></script><script src="/_next/static/chunks/b2e984c5-c6fb7c92049cce55.js" defer=""></script><script src="/_next/static/chunks/601-597bb24ff23733d9.js" defer=""></script><script src="/_next/static/chunks/675-7b1b173673ee7f53.js" defer=""></script><script src="/_next/static/chunks/518-ca43922f1257f114.js" defer=""></script><script src="/_next/static/chunks/822-db57bad4b081872d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-0262450cc7e56427.js" defer=""></script><script src="/_next/static/11uypEa77QdZrxutJBu06/_buildManifest.js" defer=""></script><script src="/_next/static/11uypEa77QdZrxutJBu06/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css?family=Raleway:400,500,700&display=swap">@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pbCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="blog-post-container content"><nav class="bg-white fixed top-0 left-0 w-full shadow flex items-center z-50" style="height:64px"><div class="relative flex-1 flex"><button type="button" class="p-4"><svg viewBox="0 0 24 24" style="width:1.5rem;height:1.5rem" role="presentation"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" style="fill:currentColor"></path></svg></button><div class="flex flex-1 text-xl font-medium items-center"><a href="/blog" class="">BLOG</a></div></div><div class="hidden md:hidden absolute bg-white w-full" style="top:64px"><a href="https://mvphub.app/" target="_blank" class="px-4 py-4 block border-t">SHOP</a><a href="/blog" target="_self" class="px-4 py-4 block border-t">BLOG</a><a href="/about" target="_self" class="px-4 py-4 block border-t">ABOUT</a></div></nav><div class="p-4 md:px-16 md:py-8 lg:px-32"><h2 class="font-bold text-2xl">Reduce your react-native android app size</h2><h6 class="text-md" style="color:#576366">19 July 2020</h6><h6 class="text-lg" style="color:#576366">By 55% with android app bundle (.aab)</h6><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div><hr class="my-8"/><div class="prose lg:prose-xl"><p>One of the many things that bother me after my React Native app went public is the app size.</p>
<p>Big app size is not a show stopper to continue adding new features to my app, nor it causes anything bad.</p>
<p>So, it has always been the least priority to work on that.</p>
<p>Some say it costs a bit of performance, if the app size is too big.</p>
<p>However, it isn&#x27;t really critical for any newly launched app for a premature optimization, on the app size.</p>
<p>I&#x27;ve always wanted to fix it (when I have the time), and I think now is the best time, because I can do it for</p>
<p>multiple projects that I am juggling, with the same optimization trick.</p>
<p>And, it&#x27;s really simple.</p>
<p>NOTE: This is an Android only optimization.</p>
<h6>Before</h6>
<p><img alt="before" node="[object Object]" post="[object Object]" loading="lazy" width="1904" height="548" decoding="async" data-nimg="1" style="color:transparent;width:100%;height:auto;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http%3A//www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 8 2&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;1&#x27;/%3E%3C/filter%3E%3Cimage preserveAspectRatio=&#x27;none&#x27; filter=&#x27;url(%23b)&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; height=&#x27;100%25&#x27; width=&#x27;100%25&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAYAAABllJ3tAAAAK0lEQVR4nF2JMQoAQAyDTP//20LH5Mh6LoLq7iKJGQH1kIQ222h301g6fh6X1BDIYRMbzAAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/_next/static/media/before.737008ec.png"/></p>
<br/>
<h6>After</h6>
<p><img alt="after" node="[object Object]" post="[object Object]" loading="lazy" width="1900" height="564" decoding="async" data-nimg="1" style="color:transparent;width:100%;height:auto;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http%3A//www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 8 2&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;1&#x27;/%3E%3C/filter%3E%3Cimage preserveAspectRatio=&#x27;none&#x27; filter=&#x27;url(%23b)&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; height=&#x27;100%25&#x27; width=&#x27;100%25&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAAAAABA/8IxAAAAHElEQVR42mP49v3nzz+/f/9k+PL954/v3398BwCL1w+EByHYKQAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/_next/static/media/after.aef1d0f8.png"/></p>
<br/>
<p>You can do it with any <em>ONE</em> of two ways below:</p>
<h4>1. Android app bundle</h4>
<p>Simply change your build process from</p>
<p><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">./gradlew assembleRelease</code></p>
<p>to</p>
<p><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">./gradlew bundleRelease</code></p>
<p>The output will be <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> file instead of <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> file.</p>
<p>Note that the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> file will not have any significant file size changes compared to the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> file.</p>
<p>The reduction in size will only be visible after uploaded the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> file to Play Store.</p>
<br/>
<h4>2. Separate Build by CPU Architecture</h4>
<p>In your project&#x27;s <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">android/app/build.gradle</code> file.</p>
<p>Update the following setting.</p>
<p><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">def enableSeparateBuildPerCPUArchitecture = true</code></p>
<pre><code class="undefined hljs"><span class="hljs-keyword">splits</span> {
    <span class="hljs-keyword">abi</span> {
        <span class="hljs-operator">...</span>
        enable enableSeparateBuildPerCPUArchitecture <span class="hljs-comment">// be sure to enable here as well</span>
        <span class="hljs-operator">...</span>
    }
}
</code></pre>
<p>Continue to build the apk as usual.</p>
<p>The output will be multiple <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> files (usually 4).</p>
<p>Each of the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> file will have significant reduction in app size.</p>
<p>Upload all of them to the Play Store for submission.</p>
<p>Worth to note that, the universal &#x27;.apk&#x27; file will not be built.</p>
<p>(The one that support all architecture, thus the heavy size.)</p>
<p>If you want it to be in the output apk, along with the others, change the following setting.</p>
<pre><code class="undefined hljs"><span class="hljs-keyword">splits</span> {
    <span class="hljs-keyword">abi</span> {
        <span class="hljs-operator">...</span>
        enable enableSeparateBuildPerCPUArchitecture
        universalApk <span class="hljs-literal">true</span>  <span class="hljs-comment">// If true, also generate a universal APK</span>
        <span class="hljs-operator">...</span>
    }
}
</code></pre>
<p>Then you will have 5 <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> files in the output folder.</p>
<p>Read about why enabling the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">universalApk</code> below.</p>
<br/>
<hr/>
<br/>
<h4>Which one to use</h4>
<p>For most of us, switching to use Android App Bundle (aab) is painless.</p>
<p>Thus, recommended to use it.</p>
<p>However, here&#x27;s are some of the things to consider.</p>
<br/>
<h5>1. Firebase App Distribution does not support (.aab) at the moment.</h5>
<p>If you use Firebase for internal distribution, you might want to use <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Separate Build by CPU Architecture</code> approach, together with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">universalApk</code> enabled.</p>
<p>What you can do is, use universal apk file for distribution, and the separated <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.apk</code> files for Play Store submission.</p>
<p>So, what about if you are using <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> file? How can you distribute the app for internal testing?</p>
<p>Well, if there are no existing tools that are already integrated into the app, and need to cater for it,
then you might want to consider using Play Store&#x27;s distribution track.</p>
<p>You can setup automated process to upload the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> file after building it to the Play Store track.</p>
<p>This require owner access though.</p>
<br/>
<h5>2. The reduction in size for both approaches are almost identical.</h5>
<p>From what I can tell, after experimenting with both approaches, and using both ways for different apps, in production.</p>
<p>The size reduction benefit is almost identical. In both cases, I got more than 50% in size reduction.</p>
<p>So the size reduction is not much of a deciding factor. Which makes us move to the next point.</p>
<br/>
<h5>3. Concern on Android App Bundle&#x27;s capabilities.</h5>
<p>For most of the app out there, App Bundle offer hassle-free switch.</p>
<p>While some of the use cases, it might be more complicated to maintain.</p>
<p>If you are not sure, refer to official documentation of Android development.</p>
<p>If you are not convinced, your app doesn&#x27;t have defined scope and complexity, or your app might
grow to eventually having very complicated/advanced use cases, you can stick to separated &#x27;.apk&#x27; approach.</p>
<p>Otherwise, using <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.aab</code> is recommended.</p>
<p>Well this post is not going to elaborate the differences of &#x27;.apk&#x27; and &#x27;.aab&#x27;, but it is worth doing your research about the topic.</p>
<br/>
<hr/>
<br/>
<h4>Conclusion</h4>
<p>With that said, you will have your Android app with very much reduced size by now!</p>
<p>For my apps, over 50% in reduction.</p>
<p>Cheers!</p>
<p>and</p>
<p>Happy coding!</p></div></div><footer class="p-4 md:p-8 lg:p-16"><div class=""><h4 class="text-xl mb-4">Contact me via:</h4><a href="https://www.linkedin.com/in/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19A1.69 1.69 0 0 0 5.19 6.88C5.19 7.81 5.95 8.56 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z" style="fill:currentColor"></path></svg></div>chinloongtan</a><div class="" style="margin-bottom:0;color:white"><a href="mailto:me@chinloongtan.com?body=Hi Chin Loong,
" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M22 6C22 4.9 21.1 4 20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6M20 6L12 11L4 6H20M20 18H4V8L12 13L20 8V18Z" style="fill:currentColor"></path></svg></div>me@chinloongtan.com</a></div></div><div class="mt-6 md:mt-16"><h4 class="text-xl mb-4">Or Buy Me A Coffee:</h4><a href="https://www.buymeacoffee.com/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white" class="flex items-center"><div class="w-12"><svg viewBox="0 0 24 24" style="width:2.25rem;height:2.25rem" role="presentation"><path d="M2,21V19H20V21H2M20,8V5H18V8H20M20,3A2,2 0 0,1 22,5V8A2,2 0 0,1 20,10H18V13A4,4 0 0,1 14,17H8A4,4 0 0,1 4,13V3H20M16,5H6V13A2,2 0 0,0 8,15H14A2,2 0 0,0 16,13V5Z" style="fill:currentColor"></path></svg></div>chinloongtan</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"content":"\nOne of the many things that bother me after my React Native app went public is the app size.\n\nBig app size is not a show stopper to continue adding new features to my app, nor it causes anything bad.\n\nSo, it has always been the least priority to work on that.\n\nSome say it costs a bit of performance, if the app size is too big.\n\nHowever, it isn't really critical for any newly launched app for a premature optimization, on the app size.\n\nI've always wanted to fix it (when I have the time), and I think now is the best time, because I can do it for\n\nmultiple projects that I am juggling, with the same optimization trick.\n\nAnd, it's really simple.\n\nNOTE: This is an Android only optimization.\n\n###### Before\n\n![before](before.png)\n\n\u003cbr /\u003e\n\n###### After\n\n![after](after.png)\n\n\u003cbr /\u003e\n\nYou can do it with any *ONE* of two ways below:\n\n#### 1. Android app bundle\n\nSimply change your build process from\n\n`./gradlew assembleRelease`\n\nto\n\n`./gradlew bundleRelease`\n\nThe output will be `.aab` file instead of `.apk` file.\n\nNote that the `.aab` file will not have any significant file size changes compared to the `.apk` file.\n\nThe reduction in size will only be visible after uploaded the `.aab` file to Play Store.\n\n\u003cbr /\u003e\n\n#### 2. Separate Build by CPU Architecture\n\nIn your project's `android/app/build.gradle` file.\n\nUpdate the following setting.\n\n`def enableSeparateBuildPerCPUArchitecture = true`\n\n```\nsplits {\n    abi {\n        ...\n        enable enableSeparateBuildPerCPUArchitecture // be sure to enable here as well\n        ...\n    }\n}\n```\n\nContinue to build the apk as usual.\n\nThe output will be multiple `.apk` files (usually 4).\n\nEach of the `.apk` file will have significant reduction in app size.\n\nUpload all of them to the Play Store for submission.\n\nWorth to note that, the universal '.apk' file will not be built.\n\n(The one that support all architecture, thus the heavy size.)\n\nIf you want it to be in the output apk, along with the others, change the following setting.\n\n```\nsplits {\n    abi {\n        ...\n        enable enableSeparateBuildPerCPUArchitecture\n        universalApk true  // If true, also generate a universal APK\n        ...\n    }\n}\n```\n\nThen you will have 5 `.apk` files in the output folder.\n\nRead about why enabling the `universalApk` below.\n\n\u003cbr /\u003e\n\n---\n\n\u003cbr /\u003e\n\n#### Which one to use\n\nFor most of us, switching to use Android App Bundle (aab) is painless.\n\nThus, recommended to use it.\n\nHowever, here's are some of the things to consider.\n\n\u003cbr /\u003e\n\n##### 1. Firebase App Distribution does not support (.aab) at the moment.\n\nIf you use Firebase for internal distribution, you might want to use `Separate Build by CPU Architecture` approach, together with `universalApk` enabled.\n\nWhat you can do is, use universal apk file for distribution, and the separated `.apk` files for Play Store submission.\n\nSo, what about if you are using `.aab` file? How can you distribute the app for internal testing?\n\nWell, if there are no existing tools that are already integrated into the app, and need to cater for it,\nthen you might want to consider using Play Store's distribution track.\n\nYou can setup automated process to upload the `.aab` file after building it to the Play Store track.\n\nThis require owner access though.\n\n\u003cbr /\u003e\n\n##### 2. The reduction in size for both approaches are almost identical.\n\nFrom what I can tell, after experimenting with both approaches, and using both ways for different apps, in production.\n\nThe size reduction benefit is almost identical. In both cases, I got more than 50% in size reduction.\n\nSo the size reduction is not much of a deciding factor. Which makes us move to the next point.\n\n\u003cbr /\u003e\n\n##### 3. Concern on Android App Bundle's capabilities.\n\nFor most of the app out there, App Bundle offer hassle-free switch.\n\nWhile some of the use cases, it might be more complicated to maintain.\n\nIf you are not sure, refer to official documentation of Android development.\n\nIf you are not convinced, your app doesn't have defined scope and complexity, or your app might\ngrow to eventually having very complicated/advanced use cases, you can stick to separated '.apk' approach.\n\nOtherwise, using `.aab` is recommended.\n\nWell this post is not going to elaborate the differences of '.apk' and '.aab', but it is worth doing your research about the topic.\n\n\u003cbr /\u003e\n\n---\n\n\u003cbr /\u003e\n\n#### Conclusion\n\nWith that said, you will have your Android app with very much reduced size by now!\n\nFor my apps, over 50% in reduction.\n\nCheers!\n\nand\n\nHappy coding!\n","frontmatter":{"path":"/blog/reduce-your-react-native-android-app-size","date":"2020-07-19T13:11:00.962Z","title":"Reduce your react-native android app size","excerpt":"By 55% with android app bundle (.aab)","tags":["react-native"]},"fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2020/07/19-android-bundle/index.md","timeToRead":4}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"reduce-your-react-native-android-app-size"},"buildId":"11uypEa77QdZrxutJBu06","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>