<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="keywords" content="react native, experienced, developer"/><meta name="title" content="Chin Loong Tan - Upgrading a 16 months old react-native project"/><meta name="description" content="From 0.59.10 to 0.62.2"/><meta name="next-head-count" content="8"/><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/35ffbb7db43c57ce.css" as="style"/><link rel="stylesheet" href="/_next/static/css/35ffbb7db43c57ce.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-36d12a75f0098f30.js" defer=""></script><script src="/_next/static/chunks/framework-36098b990598bc0c.js" defer=""></script><script src="/_next/static/chunks/main-ffc78e48a9d8baef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-89731b39aa7f4c59.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4d59f40a6e1b3add.js" defer=""></script><script src="/_next/static/chunks/143-bce4362c624c1079.js" defer=""></script><script src="/_next/static/chunks/214-e851ec31a44ce79b.js" defer=""></script><script src="/_next/static/chunks/618-75feec51ac5fbb78.js" defer=""></script><script src="/_next/static/chunks/837-c9f991aa75d605a8.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-04e04f548c0736be.js" defer=""></script><script src="/_next/static/J7l7g3QnkCAgbVIRpeln5/_buildManifest.js" defer=""></script><script src="/_next/static/J7l7g3QnkCAgbVIRpeln5/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css?family=Raleway:300,400">@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVuEorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="blog-post-container content"><div class="custom-nav"><style data-emotion="css k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="MuiBox-root css-k008qs"><style data-emotion="css 13x2oq7">.css-13x2oq7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-13x2oq7{position:absolute;}}</style><style data-emotion="css 5poeop">.css-5poeop{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-5poeop{position:absolute;}}</style><nav class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-5poeop" style="background-color:white"><style data-emotion="css i6s8oy">.css-i6s8oy{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;}@media (min-width:600px){.css-i6s8oy{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-i6s8oy{min-height:48px;}}}@media (min-width:600px){.css-i6s8oy{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-i6s8oy"><a href="/blog"><style data-emotion="css er9axy">.css-er9axy{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:black;}.css-er9axy:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-er9axy:hover{background-color:transparent;}}.css-er9axy.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css zo9a81">.css-zo9a81{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:black;}.css-zo9a81::-moz-focus-inner{border-style:none;}.css-zo9a81.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-zo9a81{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-zo9a81:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-zo9a81:hover{background-color:transparent;}}.css-zo9a81.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-edgeStart MuiIconButton-sizeMedium css-zo9a81" tabindex="0" type="button" aria-label="back"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ArrowBackIcon"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg></button></a><style data-emotion="css 13ge1hf">.css-13ge1hf{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}@media (min-width:600px){.css-13ge1hf{display:block;}}</style><div class="MuiTypography-root MuiTypography-h6 css-13ge1hf"><a style="color:black;font-family:Raleway;text-decoration:none" href="/blog">BLOG</a></div></div></nav><nav class="MuiBox-root css-0"><style data-emotion="css 12acf6p">.css-12acf6p{z-index:1200;}@media (min-width:0px){.css-12acf6p{display:block;}}@media (min-width:600px){.css-12acf6p{display:none;}}.css-12acf6p .MuiDrawer-paper{box-sizing:border-box;width:240px;}</style></nav></div></div><div class="blog-post col-md-8 offset-md-2"><h2>Upgrading a 16 months old react-native project</h2><h6 style="color:#576366">April 27, 2020</h6><h6 style="color:#576366">From 0.59.10 to 0.62.2</h6><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-weight:bold;font-family:Raleway;text-decoration:none;color:#4834d4" href="/tags/react-native">react-native<!-- --> </a></div><hr/><p>This is not the first time I&#x27;ve upgraded any react-native projects.</p>
<p>I&#x27;ve done it a few times over the years and will be sharing out what I&#x27;ve learnt so far.</p>
<p>To give you some context regarding the topic, the very same project was upgraded to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.59.10</code> since the creation with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native init</code>,
to comply with the Google Play store regulation for having 64 bit version of the app.</p>
<p>Everything works out fine with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.59.10</code>, for the next couple of months.</p>
<p>Especially one that need to deal with linking of native libraries, most of the packages have no issue with the good old <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native link</code> command.</p>
<p>With that said, I can focus on building features and be very productive with my hours spent working on projects (personal or client projects).</p>
<p>Which makes me fully occupied with work, and thus not having time for writing/bloging.</p>
<p>Now, let&#x27;s get back to the topic.</p>
<br/>
<h4>1. Before the upgrade</h4>
<p>Before any major upgrade (i.e: <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.5x.x</code> to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.60.0</code>), you need to know things are going to be broken, libraries will have issues,
deprecated API(s) will affects your app (rather than just deprecation warning), module dependencies and UI look or behaviour will have impacts.</p>
<p>There are a lot of stuffs that can possibly went wrong. So keep in mind that, upgrading is one part, regression test for your upgraded app is another part.</p>
<p>For any version upgrades you are going to perform, it is a good practice to have an overview of your <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">dependencies</code>, spot for native linked libraries and do a quick check on the potential issues after upgrade.</p>
<p>For non native linked library, there might be issue is there is a major changes in <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react</code> version itself, but most of the time this will no less of a issue.</p>
<p>In my case, there are 116 packages(dev packages excluded) installed at the point during my upgrades, and 38 of them are natively linked.</p>
<p>So I am sure it&#x27;s going to take time for the upgrade to complete. Plus after some searching the internet, I am very sure that the upgrade cannot be completed in
just few hours of time (in my case).</p>
<br/>
<h4>2. Reasons for upgrade</h4>
<p>So now you are aware that what a major upgrade will be like, and the time that it will take.</p>
<p>If there are no major blocker that are holding you back with the current version, I would suggest delaying the upgrade for a few reasons:</p>
<ul>
<li>Buffer time for libraries maintainers to support the latest feature/changes with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native</code></li>
<li>Don&#x27;t fix what isn&#x27;t broken (with trying to upgrade)</li>
</ul>
<p>Do it when you are in better position (let say you are ahead with your timeline), or when you have absolute no better choice than to upgrade (i.e: to upgrade to 64 bit support.)</p>
<p>If you are in the midst of some feature, and that feature requires for a <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native</code> version upgrade before continuing, I actually suggest going with alternatives if you can. Or do the upgrade separately, and do enough testing after the upgrade, otherwise you will find yourselves in a rabbit hole trying to fix some errors of another issue in order to make some other issues resolved. You don&#x27;t want that.</p>
<p>For example, App Store stops accepting app with WebView since April. You need to use <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-webview</code> (from a specific version onwards), and have your <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native</code> project to be at minimum xxx version.</p>
<p>You thought upgrading is the only option. Well if you are in good hand, for example your project is new and have less dependencies. Upgrading seems like a good choice if that is the case.</p>
<p>Otherwise you want just settled with the alternative, for example, removing the RCTWebView with a script that run on a <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">postinstall</code> or <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">after_install</code> Podfile, and you are good to god.</p>
<p>Chances are if you proceed with the upgrade, your <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-navigation</code> verison will not compatible with the new version, and you need to upgrade <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-navigation</code> as well. Say, from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">v3</code> to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">v4</code> with some changes in behaviour. (More on this later)</p>
<br/>
<h4>3. Which version to upgrade to</h4>
<p>If you are like me, who delaying the upgrade until you have no other choices. Chances are, you have a few major versions to choose from, since the release schedule of React Native now follows a monthly release train.
So the question for us is which version to use?</p>
<p>Well, if you have a major upgrade, normally I take the latest version within the major upgrade.
Depending on the major version of your choice, for my case from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.59.10</code>, I can upgrade to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.60.x</code>, <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.61.x</code> or <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.62.x</code>. (<code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.63.x</code> release candidate are not into consideration)</p>
<p>To have an overview of the available version, use this command.</p>
<p><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">npm show react-native versions</code></p>
<p>My choice of upgrade is to get the latest stable version for this project. Cause if I don&#x27;t do that, I will need to upgrade again sooner, and I am having huge backlogs in the pipeline after the upgrade. So I want to maximize the window before the next upgrade.</p>
<p>Bear in mind that the latest stable version might not always be the best choice to upgrade to. Sometimes you want to upgrade to a version lower that that.</p>
<p>Reason for that is the latest stable version might have breaking chances that no open source libraries has adapted yet.</p>
<p>How to know which to choose from?</p>
<ol>
<li>Inspect your <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">package.json</code> file and have a look at the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">dependencies</code> to get an idea. You are the developer of your project and should know more about which libraries will more likely to break after the upgrade.</li>
<li>Have a look at <a href="https://github.com/facebook/react-native/releases">release changelogs</a></li>
</ol>
<br/>
<h4>4. How to upgrade</h4>
<br/>
<h5>4.1 Clone the project folder</h5>
<p>I used to do it in a separate branch, but for this particular upgrade, I am doing it in a cloned folder.</p>
<p>Note: Not cloning from remote and reinstalling everything, I copy/pasted the entire folder to a different directory and start working on the upgrade.</p>
<p>Reason?</p>
<ol>
<li>I don&#x27;t want to re-installing the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">node_modules</code> and <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Pods</code> when I already have it.</li>
<li>The cloned project will build and run without issue.</li>
<li>I don&#x27;t want to switch branch and then my existing branch is messed up with my upgraded libraries (<code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">node_modules</code> and so on).
Upgrade is going on, same goes for bug fixing and feature development. I am still actively developing on the non-upgraded branch.</li>
<li>If the upgrade gone haywire, I can discard the changes in clones folder and not affecting my development flow. And start over again from the cloned folder.</li>
</ol>
<p>You want your app to still working if you decided to abort the upgrade half way, or start over again. (Yeah, sometimes, you just have to start over again.)</p>
<p>While juggling betweeen bug fixing, new features development, some optimizations, maintaining the code and version upgrade, I want to avoid the upgrade to potentially stop me from my regular work flow.
If the upgrade went wrong, I can still fix bug and ship new features of my app to App/Play stores on the main project.</p>
<h5>4.2 Use React Native upgrade helper</h5>
<p><a href="https://react-native-community.github.io/upgrade-helper/">React Native upgrade helper</a></p>
<p>Check for code changes before applying it in the project.</p>
<p>Optionally, you can upgrade with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">npx react-native upgrade</code>.</p>
<p>However, from the memory of the time I last used it, I don&#x27;t have a good experience using that.
I have to resolved conflicts and the worst part was changes on iOS <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">project.pbxproj</code> files which is a pain.</p>
<p>Ever since then I use upgrade helper and hand-picked the code and manually apply it to my existing project.
I am happy with that and is aware and consious of what I&#x27;ve changes, so I know where to look for if anything went wrong.</p>
<p>If my case, upgrading to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.62.2</code> only need to change 15 files, which is faster to do hand-picked. (Imagine the time spent on fixing conflicts could be more than that)</p>
<p>Plus, I can exclude the implementation of <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">flipper</code> which is a debugging tool included in future versions of <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native</code>.</p>
<p>Hand picking the lines makes me aware of the additional stuffs that are added (in this case, <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">flipper</code>), and I am not including it this time.</p>
<p>Reason for doing so is to not have some extra dependencies or code to fix.</p>
<p>I just want to focus on the upgrade and I can live without the debug tool for now.</p>
<p>Since coming from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.59.10</code>, I am using my other debugging tool, might as well not introduce uncertainties that will break the product.</p>
<p>I will give <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">flipper</code> a try afterwards, but for now, the upgrade is in highest priority.</p>
<p>After applying the code changes (or if your are using the upgrade command). Run <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">yarn install</code> (or <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">npm install</code> depending on your setup.)</p>
<h5>4.3 Get your project up and running</h5>
<p>After installing the versions, if there are no errors. You are good to go to start build and run the project.</p>
<p>Assuming the new packages have no issues, you need to fix the build issues with you app and get it up and running like before.</p>
<p>The following are the issues that I&#x27;ve encountered and the solution to it.
I always start debugging with iOS build with xcode. (Just a preference)</p>
<ol>
<li>Run <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">pod install</code> and bump into <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">- ERROR | attributes: Missing required attribute </code>homepage<code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.</code></li>
</ol>
<p>Since <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.60.0</code>, native libraries are now auto linked. That means you don&#x27;t have to specify the pod in your <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Podfile</code> anymore and React Native will pick that up. (some changes to <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Podfile</code> requires)
And for this reason, native libraries are required to have a <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.podspec</code> file for that to work.
If the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">homepage</code> are set to empty string <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">s.homepage = &#x27;&#x27;</code> you will get this issue.</p>
<p>I am getting this issue for this package <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">https://github.com/Aminoid/react-native-activity-recognition</code></p>
<p>The fix: Fork the repository and add a homepage to it. (There are another issue with this library&#x27;s podspec, so forking the library is a better choice, more about this later)</p>
<ol start="2">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">CocoaPods could not find compatible versions for pod &quot;React/Core&quot;:</code></li>
</ol>
<p>This is a issue with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-image-crop-picker</code> library. Upgrading the library will fix it.
Since the dependency is now <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">React-Core</code>.</p>
<ol start="3">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">YOUR_PROJECT_PATH/node_modules/react-native/React/Modules/RCTEventEmitter.h:8:9: &#x27;React/RCTBridge.h&#x27; file not found</code></li>
</ol>
<p>Got this issue for <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-audio-recorder-player</code>. As you can tell, upgrading the library will fix it.</p>
<ol start="4">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">&#x27;React/RCTDefines.h&#x27; file not found</code></li>
</ol>
<p>This one has to do with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">AppCenter</code> packages.</p>
<p>And the fix for this is well documented <a href="https://docs.microsoft.com/en-us/appcenter/sdk/troubleshooting/react-native">here</a>.</p>
<ol start="5">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">&lt;React/RCTBridgeModule.h&gt; file not found</code></li>
</ol>
<p>Now this is the real tricky part.</p>
<p>At this point, the header file is missing, and we are not sure, whether it is an error that only happens to this library only or all other libraries.
For this, there is a way to inspect the issue.</p>
<p>This is very well written in this Github comment, so I am not going to elaborate futher.</p>
<p>https://github.com/facebook/react-native/issues/26665#issuecomment-571082076</p>
<p>In short, I have to remove the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">target.remove_from_project</code> from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Podfile</code> <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">post_install</code></p>
<p>then</p>
<pre><code class="undefined hljs">pod deintegrate
pod <span class="hljs-keyword">cache </span>clean
pod <span class="hljs-keyword">install
</span></code></pre>
<p>(not enough with just removing the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Pods</code> directory)</p>
<p>and add the missing react back to scheme &gt; build (for all the targets!)</p>
<ol start="6">
<li>Remove from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Libraries</code> folder in xcode, all the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">.xcodeproj</code> and all the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">xxx.a</code> from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Build Phases &gt; Link Binary with Libraries</code> from native libraries if you haven&#x27;t.</li>
</ol>
<p>Or use <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native unlink</code> (but again, I do it manually from xcode, because I don&#x27;t want to unlink for android yet, as it turns out, android works without unlinking, but is is now redundant.)</p>
<p>Otherwise app will have duplicated headers from Pods and the Libraries projects.</p>
<ol start="7">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">MKTouchableManager.m:11:9: error: &#x27;UIView+React.h&#x27; file not found with &lt;angled&gt; include; use &quot;quotes&quot; instead</code></li>
</ol>
<p>Then I am having this issue with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-material-kit</code>. I use this for ranged slider with two thumbs. Looking for alternatives, but I am fixing this one first.</p>
<p>Turns out upgrading the project to the latest version fixed the issue.</p>
<ol start="8">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">No known class method for selector &#x27;configure&#x27;</code></li>
</ol>
<p>Then this issue, from firebase, basically I need to use firebase v6 instead of v5. Well, another breaking changes.
Since local push notification are no longer usable in v6. I need to find solution for that. So in this case, upgrade to v6,
and comment out implementation for local push notification and come back to this later.
(Remember, we want to build and run the app and not spending too much time replacing the implementation and then we don&#x27;t know why it is not working. Do one thing at a time. Complete the upgrade first.)</p>
<p>Upgrading to v6 has no much issues, also because the only thing that was in used with firebase is the local push notification. (but there are plans to use the Crashlytics, part of the reason why the upgrade is done)
And of course, the documentation on the website is great. I am using <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-firebase</code>. (Sometimes the documentation update is so frequent that old documentation is not there anymore, so just keep up to date with the latest version as best as you can.)</p>
<hr/>
<p>At this point, the app can be built and run on simulator already.</p>
<hr/>
<ol start="9">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Invariant Violation: Native module cannot be null.</code> and <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">&#x27;React/RCTEventEmitter.h&#x27; file not found</code></li>
</ol>
<p>This is from the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-activity-recognition</code> library I am using. Second issue from the same library.
And it has to do with a incorrect path in <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">podspec</code> being used. Before this I fixed it with importing the project to library and manually link the library code.
But now I need to use Podfile and this has to be fixed with updating the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">podspec</code> of the library.</p>
<p>Solution: Fork the repository, update the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">podspec</code> and install it in your app.</p>
<ol start="10">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">null is not an object (evaluating &#x27;_ReanimatedModule.default.createNode&#x27;)</code></li>
</ol>
<p>This has to do with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-tab-view</code>. Upgrade the <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-tab-view</code> and <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-reanimated</code> to the latest version.
Run <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">pod install</code> for <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-reanimated</code> to be updated.</p>
<ol start="11">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Undefined is not an object (evaluating &#x27;navigator.geolocation.getCurrentPosition&#x27;)</code></li>
</ol>
<p><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">navigator</code> is no longer available from the global object.
Install and use the it from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">https://github.com/react-native-community/react-native-geolocation</code> instead.</p>
<ol start="12">
<li>Also deprecated APIs are: <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">ViewPager</code> and <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">ListView</code></li>
</ol>
<p>If you are using libraries that depends on these APIs, you will need to upgrade the library as well. Or replace/remove the APIs in your app.</p>
<ol start="13">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">Cannot read property measureInWindow of undefined</code></li>
</ol>
<p>Issue with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-navigation</code> v3. You will need to use v4 or v5.</p>
<p>From v3 to v4 has some minor changes. From v3 or v4 to v5 will have API changes. So upgrade with care.</p>
<p>For me, I opt to upgrade to v4 and still have some unexpected changes in behaviour. And need to fix it.</p>
<p>As you know, the local push notification is now broken, so I want to just stay with v4 to have less code that broken.</p>
<p>And when the app are back up to where, then I will consider upgrading to v5.</p>
<ol start="14">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">TypeError: Cannot call a class a function</code></li>
</ol>
<p>This is a changes in the code that I wrote, it is now illegal to do that, I haven&#x27;t investigated further whether the changes is from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-navigation</code> or <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react</code> library.
But I managed to figured out the issue.</p>
<p>Code with issue: (works with <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">0.59.10</code>)</p>
<pre><code class="undefined hljs">headerLeft: NavHeader.<span class="hljs-built_in">Back</span>,
</code></pre>
<p>Code changes after the upgrade:</p>
<pre><code class="undefined hljs">headerLeft: <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> &lt;NavHeader.<span class="hljs-built_in">Back</span> {...props} /&gt;
</code></pre>
<p>You should be able to tell what&#x27;s wrong from the error description. (<code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">NavHeader</code> is a class component)</p>
<ol start="15">
<li>Issue with PagerPan from <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">react-native-tab-view</code></li>
</ol>
<p>Code with issue:</p>
<pre><code class="undefined hljs"><span class="hljs-keyword">import</span> { TabView, SceneMap, PagerPan } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-tab-view&#x27;</span>;
</code></pre>
<p>Code changes:</p>
<pre><code class="undefined hljs"><span class="hljs-keyword">import</span> { TabView, SceneMap, ScrollPager <span class="hljs-keyword">as</span> PagerPan } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-native-tab-view&#x27;</span>;
</code></pre>
<p>However, even after the fix, the behaviour is not the same, therefore more work has to be done to disable animation and swipe on the tab.</p>
<ol start="16">
<li><code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">AirGoogleMaps</code> dir must be added to your xCode project to support GoogleMaps on iOS.</li>
</ol>
<p>Upgrade the library and make sure to run <code style="background-color:rgba(0,0,0,.04);padding-top:3px;padding-bottom:3px">pod install</code></p>
<h5>End</h5>
<p>Hopefully my writing can help you with the upgrade. Happy coding.</p>
<p>I will be writing up with the upgraded project next.</p>
<br/></div><footer class=""><div class="container"><h4 class="">Contact me via:</h4><a href="https://www.linkedin.com/in/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white"><span style="color:white;margin-right:15px;margin-top:15px;margin-bottom:15px" aria-hidden="true" class="fa fa-linkedin-square fa-2x"></span>https://www.linkedin.com/in/chinloongtan</a><div class="" style="margin-bottom:0;color:white"><a href="mailto:me@chinloongtan.com?body=Hi Chin Loong,
" style="color:white"><span style="color:white;margin-right:10px;margin-top:15px;margin-bottom:15px" aria-hidden="true" class="fa fa-envelope-open-o fa-2x"></span>me@chinloongtan.com</a></div></div><div class="container"><h4 class="">Or Buy Me A Coffee:</h4><a href="https://www.buymeacoffee.com/chinloongtan" target="_blank" rel="noopener noreferrer" style="color:white"><span style="color:white;margin-right:15px;margin-top:15px;margin-bottom:15px" aria-hidden="true" class="fa fa-coffee fa-2x"></span>https://www.buymeacoffee.com/chinloongtan</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"content":"\nThis is not the first time I've upgraded any react-native projects.\n\nI've done it a few times over the years and will be sharing out what I've learnt so far.\n\nTo give you some context regarding the topic, the very same project was upgraded to `0.59.10` since the creation with `react-native init`,\nto comply with the Google Play store regulation for having 64 bit version of the app.\n\nEverything works out fine with `0.59.10`, for the next couple of months.\n\nEspecially one that need to deal with linking of native libraries, most of the packages have no issue with the good old `react-native link` command.\n\nWith that said, I can focus on building features and be very productive with my hours spent working on projects (personal or client projects).\n\nWhich makes me fully occupied with work, and thus not having time for writing/bloging.\n\nNow, let's get back to the topic.\n\n\u003cbr /\u003e\n\n#### 1. Before the upgrade\n\nBefore any major upgrade (i.e: `0.5x.x` to `0.60.0`), you need to know things are going to be broken, libraries will have issues,\ndeprecated API(s) will affects your app (rather than just deprecation warning), module dependencies and UI look or behaviour will have impacts.\n\nThere are a lot of stuffs that can possibly went wrong. So keep in mind that, upgrading is one part, regression test for your upgraded app is another part.\n\nFor any version upgrades you are going to perform, it is a good practice to have an overview of your `dependencies`, spot for native linked libraries and do a quick check on the potential issues after upgrade.\n\nFor non native linked library, there might be issue is there is a major changes in `react` version itself, but most of the time this will no less of a issue.\n\n\nIn my case, there are 116 packages(dev packages excluded) installed at the point during my upgrades, and 38 of them are natively linked.\n\nSo I am sure it's going to take time for the upgrade to complete. Plus after some searching the internet, I am very sure that the upgrade cannot be completed in\njust few hours of time (in my case).\n\n\u003cbr /\u003e\n\n#### 2. Reasons for upgrade\n\nSo now you are aware that what a major upgrade will be like, and the time that it will take.\n\nIf there are no major blocker that are holding you back with the current version, I would suggest delaying the upgrade for a few reasons:\n\n- Buffer time for libraries maintainers to support the latest feature/changes with `react-native`\n- Don't fix what isn't broken (with trying to upgrade)\n\nDo it when you are in better position (let say you are ahead with your timeline), or when you have absolute no better choice than to upgrade (i.e: to upgrade to 64 bit support.)\n\nIf you are in the midst of some feature, and that feature requires for a `react-native` version upgrade before continuing, I actually suggest going with alternatives if you can. Or do the upgrade separately, and do enough testing after the upgrade, otherwise you will find yourselves in a rabbit hole trying to fix some errors of another issue in order to make some other issues resolved. You don't want that.\n\nFor example, App Store stops accepting app with WebView since April. You need to use `react-native-webview` (from a specific version onwards), and have your `react-native` project to be at minimum xxx version.\n\nYou thought upgrading is the only option. Well if you are in good hand, for example your project is new and have less dependencies. Upgrading seems like a good choice if that is the case.\n\nOtherwise you want just settled with the alternative, for example, removing the RCTWebView with a script that run on a `postinstall` or `after_install` Podfile, and you are good to god.\n\nChances are if you proceed with the upgrade, your `react-navigation` verison will not compatible with the new version, and you need to upgrade `react-navigation` as well. Say, from `v3` to `v4` with some changes in behaviour. (More on this later)\n\n\u003cbr /\u003e\n\n#### 3. Which version to upgrade to\n\nIf you are like me, who delaying the upgrade until you have no other choices. Chances are, you have a few major versions to choose from, since the release schedule of React Native now follows a monthly release train.\nSo the question for us is which version to use?\n\nWell, if you have a major upgrade, normally I take the latest version within the major upgrade.\nDepending on the major version of your choice, for my case from `0.59.10`, I can upgrade to `0.60.x`, `0.61.x` or `0.62.x`. (`0.63.x` release candidate are not into consideration)\n\nTo have an overview of the available version, use this command.\n\n`npm show react-native versions`\n\nMy choice of upgrade is to get the latest stable version for this project. Cause if I don't do that, I will need to upgrade again sooner, and I am having huge backlogs in the pipeline after the upgrade. So I want to maximize the window before the next upgrade.\n\nBear in mind that the latest stable version might not always be the best choice to upgrade to. Sometimes you want to upgrade to a version lower that that.\n\nReason for that is the latest stable version might have breaking chances that no open source libraries has adapted yet.\n\nHow to know which to choose from?\n\n1. Inspect your `package.json` file and have a look at the `dependencies` to get an idea. You are the developer of your project and should know more about which libraries will more likely to break after the upgrade.\n2. Have a look at [release changelogs](https://github.com/facebook/react-native/releases)\n\n\u003cbr /\u003e\n\n#### 4. How to upgrade\n\n\u003cbr /\u003e\n\n##### 4.1 Clone the project folder\n\nI used to do it in a separate branch, but for this particular upgrade, I am doing it in a cloned folder.\n\nNote: Not cloning from remote and reinstalling everything, I copy/pasted the entire folder to a different directory and start working on the upgrade.\n\nReason?\n\n1. I don't want to re-installing the `node_modules` and `Pods` when I already have it.\n2. The cloned project will build and run without issue.\n3. I don't want to switch branch and then my existing branch is messed up with my upgraded libraries (`node_modules` and so on).\nUpgrade is going on, same goes for bug fixing and feature development. I am still actively developing on the non-upgraded branch.\n4. If the upgrade gone haywire, I can discard the changes in clones folder and not affecting my development flow. And start over again from the cloned folder.\n\nYou want your app to still working if you decided to abort the upgrade half way, or start over again. (Yeah, sometimes, you just have to start over again.)\n\nWhile juggling betweeen bug fixing, new features development, some optimizations, maintaining the code and version upgrade, I want to avoid the upgrade to potentially stop me from my regular work flow.\nIf the upgrade went wrong, I can still fix bug and ship new features of my app to App/Play stores on the main project.\n\n##### 4.2 Use React Native upgrade helper\n\n[React Native upgrade helper](https://react-native-community.github.io/upgrade-helper/)\n\nCheck for code changes before applying it in the project.\n\nOptionally, you can upgrade with `npx react-native upgrade`.\n\nHowever, from the memory of the time I last used it, I don't have a good experience using that.\nI have to resolved conflicts and the worst part was changes on iOS `project.pbxproj` files which is a pain.\n\nEver since then I use upgrade helper and hand-picked the code and manually apply it to my existing project.\nI am happy with that and is aware and consious of what I've changes, so I know where to look for if anything went wrong.\n\nIf my case, upgrading to `0.62.2` only need to change 15 files, which is faster to do hand-picked. (Imagine the time spent on fixing conflicts could be more than that)\n\nPlus, I can exclude the implementation of `flipper` which is a debugging tool included in future versions of `react-native`.\n\nHand picking the lines makes me aware of the additional stuffs that are added (in this case, `flipper`), and I am not including it this time.\n\nReason for doing so is to not have some extra dependencies or code to fix.\n\nI just want to focus on the upgrade and I can live without the debug tool for now.\n\nSince coming from `0.59.10`, I am using my other debugging tool, might as well not introduce uncertainties that will break the product.\n\nI will give `flipper` a try afterwards, but for now, the upgrade is in highest priority.\n\nAfter applying the code changes (or if your are using the upgrade command). Run `yarn install` (or `npm install` depending on your setup.)\n\n##### 4.3 Get your project up and running\n\nAfter installing the versions, if there are no errors. You are good to go to start build and run the project.\n\nAssuming the new packages have no issues, you need to fix the build issues with you app and get it up and running like before.\n\nThe following are the issues that I've encountered and the solution to it.\nI always start debugging with iOS build with xcode. (Just a preference)\n\n1. Run `pod install` and bump into `- ERROR | attributes: Missing required attribute `homepage`.`\n\nSince `0.60.0`, native libraries are now auto linked. That means you don't have to specify the pod in your `Podfile` anymore and React Native will pick that up. (some changes to `Podfile` requires)\nAnd for this reason, native libraries are required to have a `.podspec` file for that to work.\nIf the `homepage` are set to empty string `s.homepage = ''` you will get this issue.\n\nI am getting this issue for this package `https://github.com/Aminoid/react-native-activity-recognition`\n\nThe fix: Fork the repository and add a homepage to it. (There are another issue with this library's podspec, so forking the library is a better choice, more about this later)\n\n2. `CocoaPods could not find compatible versions for pod \"React/Core\":`\n\nThis is a issue with `react-native-image-crop-picker` library. Upgrading the library will fix it.\nSince the dependency is now `React-Core`.\n\n3. `YOUR_PROJECT_PATH/node_modules/react-native/React/Modules/RCTEventEmitter.h:8:9: 'React/RCTBridge.h' file not found`\n\nGot this issue for `react-native-audio-recorder-player`. As you can tell, upgrading the library will fix it.\n\n4. `'React/RCTDefines.h' file not found`\n\nThis one has to do with `AppCenter` packages.\n\nAnd the fix for this is well documented [here](https://docs.microsoft.com/en-us/appcenter/sdk/troubleshooting/react-native).\n\n5. `\u003cReact/RCTBridgeModule.h\u003e file not found`\n\nNow this is the real tricky part.\n\nAt this point, the header file is missing, and we are not sure, whether it is an error that only happens to this library only or all other libraries.\nFor this, there is a way to inspect the issue.\n\nThis is very well written in this Github comment, so I am not going to elaborate futher.\n\nhttps://github.com/facebook/react-native/issues/26665#issuecomment-571082076\n\nIn short, I have to remove the `target.remove_from_project` from `Podfile` `post_install`\n\nthen\n\n```\npod deintegrate\npod cache clean\npod install\n```\n\n(not enough with just removing the `Pods` directory)\n\nand add the missing react back to scheme \u003e build (for all the targets!)\n\n6. Remove from `Libraries` folder in xcode, all the `.xcodeproj` and all the `xxx.a` from `Build Phases \u003e Link Binary with Libraries` from native libraries if you haven't.\n\nOr use `react-native unlink` (but again, I do it manually from xcode, because I don't want to unlink for android yet, as it turns out, android works without unlinking, but is is now redundant.)\n\nOtherwise app will have duplicated headers from Pods and the Libraries projects.\n\n7. `MKTouchableManager.m:11:9: error: 'UIView+React.h' file not found with \u003cangled\u003e include; use \"quotes\" instead`\n\nThen I am having this issue with `react-native-material-kit`. I use this for ranged slider with two thumbs. Looking for alternatives, but I am fixing this one first.\n\nTurns out upgrading the project to the latest version fixed the issue.\n\n8. `No known class method for selector 'configure'`\n\nThen this issue, from firebase, basically I need to use firebase v6 instead of v5. Well, another breaking changes.\nSince local push notification are no longer usable in v6. I need to find solution for that. So in this case, upgrade to v6,\nand comment out implementation for local push notification and come back to this later.\n(Remember, we want to build and run the app and not spending too much time replacing the implementation and then we don't know why it is not working. Do one thing at a time. Complete the upgrade first.)\n\nUpgrading to v6 has no much issues, also because the only thing that was in used with firebase is the local push notification. (but there are plans to use the Crashlytics, part of the reason why the upgrade is done)\nAnd of course, the documentation on the website is great. I am using `react-native-firebase`. (Sometimes the documentation update is so frequent that old documentation is not there anymore, so just keep up to date with the latest version as best as you can.)\n\n---\n\nAt this point, the app can be built and run on simulator already.\n\n---\n\n9. `Invariant Violation: Native module cannot be null.` and `'React/RCTEventEmitter.h' file not found`\n\nThis is from the `react-native-activity-recognition` library I am using. Second issue from the same library.\nAnd it has to do with a incorrect path in `podspec` being used. Before this I fixed it with importing the project to library and manually link the library code.\nBut now I need to use Podfile and this has to be fixed with updating the `podspec` of the library.\n\nSolution: Fork the repository, update the `podspec` and install it in your app.\n\n10. `null is not an object (evaluating '_ReanimatedModule.default.createNode')`\n\nThis has to do with `react-native-tab-view`. Upgrade the `react-native-tab-view` and `react-native-reanimated` to the latest version.\nRun `pod install` for `react-native-reanimated` to be updated.\n\n11. `Undefined is not an object (evaluating 'navigator.geolocation.getCurrentPosition')`\n\n`navigator` is no longer available from the global object.\nInstall and use the it from `https://github.com/react-native-community/react-native-geolocation` instead.\n\n12. Also deprecated APIs are: `ViewPager` and `ListView`\n\nIf you are using libraries that depends on these APIs, you will need to upgrade the library as well. Or replace/remove the APIs in your app.\n\n13. `Cannot read property measureInWindow of undefined`\n\nIssue with `react-navigation` v3. You will need to use v4 or v5.\n\nFrom v3 to v4 has some minor changes. From v3 or v4 to v5 will have API changes. So upgrade with care.\n\nFor me, I opt to upgrade to v4 and still have some unexpected changes in behaviour. And need to fix it.\n\nAs you know, the local push notification is now broken, so I want to just stay with v4 to have less code that broken.\n\nAnd when the app are back up to where, then I will consider upgrading to v5.\n\n14. `TypeError: Cannot call a class a function`\n\nThis is a changes in the code that I wrote, it is now illegal to do that, I haven't investigated further whether the changes is from `react-navigation` or `react` library.\nBut I managed to figured out the issue.\n\nCode with issue: (works with `0.59.10`)\n\n```\nheaderLeft: NavHeader.Back,\n```\n\nCode changes after the upgrade:\n\n```\nheaderLeft: props =\u003e \u003cNavHeader.Back {...props} /\u003e\n```\n\nYou should be able to tell what's wrong from the error description. (`NavHeader` is a class component)\n\n15. Issue with PagerPan from `react-native-tab-view`\n\nCode with issue:\n\n```\nimport { TabView, SceneMap, PagerPan } from 'react-native-tab-view';\n```\n\nCode changes:\n\n```\nimport { TabView, SceneMap, ScrollPager as PagerPan } from 'react-native-tab-view';\n```\n\nHowever, even after the fix, the behaviour is not the same, therefore more work has to be done to disable animation and swipe on the tab.\n\n\n16. `AirGoogleMaps` dir must be added to your xCode project to support GoogleMaps on iOS.\n\nUpgrade the library and make sure to run `pod install`\n\n##### End\n\nHopefully my writing can help you with the upgrade. Happy coding.\n\nI will be writing up with the upgraded project next.\n\n\u003cbr /\u003e\n\n","frontmatter":{"path":"/blog/upgrading-react-native-project","date":"2020-04-27T13:52:00.962Z","title":"Upgrading a 16 months old react-native project","excerpt":"From 0.59.10 to 0.62.2","tags":["react-native"]},"fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2020/04/27-upgrade-rn/index.md","timeToRead":12}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"upgrading-react-native-project"},"buildId":"J7l7g3QnkCAgbVIRpeln5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>