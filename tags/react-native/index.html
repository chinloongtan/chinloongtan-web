<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/assets/favicon.png"/><meta name="keywords" content="react native, experienced, developer"/><title>Chin Loong Tan - Tags/react-native</title><meta name="title" content="Chin Loong Tan - Tags/react-native"/><meta name="description" content="Tags/react-native"/><meta name="next-head-count" content="10"/><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/b8bccfa5ba1384be.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8bccfa5ba1384be.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa7b150fda7c19e.js" defer=""></script><script src="/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/_next/static/chunks/main-292e4726b4fd03ef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7b88cd2d90789639.js" defer=""></script><script src="/_next/static/chunks/b2e984c5-c6fb7c92049cce55.js" defer=""></script><script src="/_next/static/chunks/518-ca43922f1257f114.js" defer=""></script><script src="/_next/static/chunks/pages/tags/%5Btag%5D-0016c2600f658d2c.js" defer=""></script><script src="/_next/static/9TO4ALtp1qxTSA0DNeSWz/_buildManifest.js" defer=""></script><script src="/_next/static/9TO4ALtp1qxTSA0DNeSWz/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css?family=Raleway:400,500,700&display=swap">@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoorCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pbCIPrc.woff) format('woff')}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCAIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCkIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCIIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyCMIT4ttDfCmxA.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Raleway';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v28/1Ptug8zYS_SKggPNyC0IT4ttDfA.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="blog-posts content"><nav class="bg-white fixed top-0 left-0 w-full shadow flex items-center z-50" style="height:64px"><div class="relative flex-1 flex"><button type="button" class="p-4"><svg viewBox="0 0 24 24" style="width:1.5rem;height:1.5rem" role="presentation"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" style="fill:currentColor"></path></svg></button><div class="flex flex-1 text-xl font-medium items-center"><a href="/" class="">TAGS/react-native</a></div></div><div class="hidden md:hidden absolute bg-white w-full" style="top:64px"><a href="https://mvphub.app/" target="_blank" class="px-4 py-4 block border-t">SHOP</a><a href="/blog" target="_self" class="px-4 py-4 block border-t">BLOG</a><a href="/about" target="_self" class="px-4 py-4 block border-t">ABOUT</a></div></nav><div class="py-4 px-6 md:px-16 lg:px-32 text-grey"><b class="text-black">10</b> post<!-- -->s<!-- --> tagged with <b class="text-black">&quot;<!-- -->react-native<!-- -->&quot;</b><br/><a class="text-primaryBlue font-medium" href="/tags/">View all tags</a></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/upgrading-react-native-project/"><h4 class="font-bold text-xl">Upgrading a 16 months old react-native project</h4><h6 class="text-md" style="color:#576366">27 April 2020</h6><div class="text-base mt-2"><span style="color:#576366">From 0.59.10 to 0.62.2</span><span class="text-sm block md:float-right">12<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/reduce-your-react-native-android-app-size/"><h4 class="font-bold text-xl">Reduce your react-native android app size</h4><h6 class="text-md" style="color:#576366">19 July 2020</h6><div class="text-base mt-2"><span style="color:#576366">By 55% with android app bundle (.aab)</span><span class="text-sm block md:float-right">4<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/android-accessing-cached-image-dir/"><h4 class="font-bold text-xl">Access to android files in cache directory</h4><h6 class="text-md" style="color:#576366">26 July 2020</h6><div class="text-base mt-2"><span style="color:#576366">Using adb cli</span><span class="text-sm block md:float-right">1<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/android/">android<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/layout-animation-in-a-nutshell/"><h4 class="font-bold text-xl">LayoutAnimation in a nutshell</h4><h6 class="text-md" style="color:#576366">15 January 2021</h6><div class="text-base mt-2"><span style="color:#576366">Simple and powerfull, even for complicated layouts</span><span class="text-sm block md:float-right">1<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/react-native-listen-to-port-other-than-8081/"><h4 class="font-bold text-xl">React Native Listen to Port Other Than 8081</h4><h6 class="text-md" style="color:#576366">17 January 2022</h6><div class="text-base mt-2"><span style="color:#576366">A different approach using RCT_METRO_PORT</span><span class="text-sm block md:float-right">1<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/ios-shared-userdefaults-for-app-extensions-with-rctbridgemodule/"><h4 class="font-bold text-xl">iOS Shared UserDefaults for App Extensions With RCTBridgeModule</h4><h6 class="text-md" style="color:#576366">20 January 2022</h6><div class="text-base mt-2"><span style="color:#576366">Get/Set key-value from both React Native and Swift/Obj-C</span><span class="text-sm block md:float-right">2<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/ios/">ios<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/remove-unused-and-reorder-imports/"><h4 class="font-bold text-xl">Remove unused and reorder imports</h4><h6 class="text-md" style="color:#576366">21 January 2022</h6><div class="text-base mt-2"><span style="color:#576366">With ESLint and VS Code</span><span class="text-sm block md:float-right">2<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a><a style="margin-right:10px;background-color:rgba(0, 185, 96, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#00b960" class="font-medium" href="/tags/typescript/">typescript<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/another-react-native-project-upgrade/"><h4 class="font-bold text-xl">Another react-native project upgrade</h4><h6 class="text-md" style="color:#576366">9 February 2022</h6><div class="text-base mt-2"><span style="color:#576366">To 0.66.4</span><span class="text-sm block md:float-right">3<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/react-native-project-upgrade-march-2023/"><h4 class="font-bold text-xl">react-native project upgrade</h4><h6 class="text-md" style="color:#576366">24 March 2023</h6><div class="text-base mt-2"><span style="color:#576366">To 0.70.6</span><span class="text-sm block md:float-right">2<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div><div class="px-4 md:px-16 lg:px-32"><div class="blog-post-preview"><a style="color:black" class="blog-post-preview-link" href="/blog/redux-ducks-pattern/"><h4 class="font-bold text-xl">&quot;Redux Ducks&quot; pattern, redux-toolkit, redux-saga and circular dependencies</h4><h6 class="text-md" style="color:#576366">24 June 2023</h6><div class="text-base mt-2"><span style="color:#576366">Adopting tools and pattern</span><span class="text-sm block md:float-right">2<!-- --> min read</span></div></a><div style="flex-direction:row;display:flex;margin-top:10px;font-size:14px;flex-wrap:wrap"><a style="margin-right:10px;background-color:rgba(72, 52, 212, 0.3);padding:5px;padding-left:8px;padding-right:8px;border-radius:6px;font-family:Raleway;text-decoration:none;color:#4834d4" class="font-medium" href="/tags/react-native/">react-native<!-- --> </a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"slug":"upgrading-react-native-project","frontmatter":{"path":"/blog/upgrading-react-native-project","date":"2020-04-27T13:52:00.962Z","title":"Upgrading a 16 months old react-native project","excerpt":"From 0.59.10 to 0.62.2","tags":["react-native"]},"content":"\nThis is not the first time I've upgraded any react-native projects.\n\nI've done it a few times over the years and will be sharing out what I've learnt so far.\n\nTo give you some context regarding the topic, the very same project was upgraded to `0.59.10` since the creation with `react-native init`,\nto comply with the Google Play store regulation for having 64 bit version of the app.\n\nEverything works out fine with `0.59.10`, for the next couple of months.\n\nEspecially one that need to deal with linking of native libraries, most of the packages have no issue with the good old `react-native link` command.\n\nWith that said, I can focus on building features and be very productive with my hours spent working on projects (personal or client projects).\n\nWhich makes me fully occupied with work, and thus not having time for writing/bloging.\n\nNow, let's get back to the topic.\n\n\u003cbr /\u003e\n\n#### 1. Before the upgrade\n\nBefore any major upgrade (i.e: `0.5x.x` to `0.60.0`), you need to know things are going to be broken, libraries will have issues,\ndeprecated API(s) will affects your app (rather than just deprecation warning), module dependencies and UI look or behaviour will have impacts.\n\nThere are a lot of stuffs that can possibly went wrong. So keep in mind that, upgrading is one part, regression test for your upgraded app is another part.\n\nFor any version upgrades you are going to perform, it is a good practice to have an overview of your `dependencies`, spot for native linked libraries and do a quick check on the potential issues after upgrade.\n\nFor non native linked library, there might be issue is there is a major changes in `react` version itself, but most of the time this will no less of a issue.\n\n\nIn my case, there are 116 packages(dev packages excluded) installed at the point during my upgrades, and 38 of them are natively linked.\n\nSo I am sure it's going to take time for the upgrade to complete. Plus after some searching the internet, I am very sure that the upgrade cannot be completed in\njust few hours of time (in my case).\n\n\u003cbr /\u003e\n\n#### 2. Reasons for upgrade\n\nSo now you are aware that what a major upgrade will be like, and the time that it will take.\n\nIf there are no major blocker that are holding you back with the current version, I would suggest delaying the upgrade for a few reasons:\n\n- Buffer time for libraries maintainers to support the latest feature/changes with `react-native`\n- Don't fix what isn't broken (with trying to upgrade)\n\nDo it when you are in better position (let say you are ahead with your timeline), or when you have absolute no better choice than to upgrade (i.e: to upgrade to 64 bit support.)\n\nIf you are in the midst of some feature, and that feature requires for a `react-native` version upgrade before continuing, I actually suggest going with alternatives if you can. Or do the upgrade separately, and do enough testing after the upgrade, otherwise you will find yourselves in a rabbit hole trying to fix some errors of another issue in order to make some other issues resolved. You don't want that.\n\nFor example, App Store stops accepting app with WebView since April. You need to use `react-native-webview` (from a specific version onwards), and have your `react-native` project to be at minimum xxx version.\n\nYou thought upgrading is the only option. Well if you are in good hand, for example your project is new and have less dependencies. Upgrading seems like a good choice if that is the case.\n\nOtherwise you want just settled with the alternative, for example, removing the RCTWebView with a script that run on a `postinstall` or `after_install` Podfile, and you are good to god.\n\nChances are if you proceed with the upgrade, your `react-navigation` verison will not compatible with the new version, and you need to upgrade `react-navigation` as well. Say, from `v3` to `v4` with some changes in behaviour. (More on this later)\n\n\u003cbr /\u003e\n\n#### 3. Which version to upgrade to\n\nIf you are like me, who delaying the upgrade until you have no other choices. Chances are, you have a few major versions to choose from, since the release schedule of React Native now follows a monthly release train.\nSo the question for us is which version to use?\n\nWell, if you have a major upgrade, normally I take the latest version within the major upgrade.\nDepending on the major version of your choice, for my case from `0.59.10`, I can upgrade to `0.60.x`, `0.61.x` or `0.62.x`. (`0.63.x` release candidate are not into consideration)\n\nTo have an overview of the available version, use this command.\n\n`npm show react-native versions`\n\nMy choice of upgrade is to get the latest stable version for this project. Cause if I don't do that, I will need to upgrade again sooner, and I am having huge backlogs in the pipeline after the upgrade. So I want to maximize the window before the next upgrade.\n\nBear in mind that the latest stable version might not always be the best choice to upgrade to. Sometimes you want to upgrade to a version lower that that.\n\nReason for that is the latest stable version might have breaking chances that no open source libraries has adapted yet.\n\nHow to know which to choose from?\n\n1. Inspect your `package.json` file and have a look at the `dependencies` to get an idea. You are the developer of your project and should know more about which libraries will more likely to break after the upgrade.\n2. Have a look at [release changelogs](https://github.com/facebook/react-native/releases)\n\n\u003cbr /\u003e\n\n#### 4. How to upgrade\n\n\u003cbr /\u003e\n\n##### 4.1 Clone the project folder\n\nI used to do it in a separate branch, but for this particular upgrade, I am doing it in a cloned folder.\n\nNote: Not cloning from remote and reinstalling everything, I copy/pasted the entire folder to a different directory and start working on the upgrade.\n\nReason?\n\n1. I don't want to re-installing the `node_modules` and `Pods` when I already have it.\n2. The cloned project will build and run without issue.\n3. I don't want to switch branch and then my existing branch is messed up with my upgraded libraries (`node_modules` and so on).\nUpgrade is going on, same goes for bug fixing and feature development. I am still actively developing on the non-upgraded branch.\n4. If the upgrade gone haywire, I can discard the changes in clones folder and not affecting my development flow. And start over again from the cloned folder.\n\nYou want your app to still working if you decided to abort the upgrade half way, or start over again. (Yeah, sometimes, you just have to start over again.)\n\nWhile juggling betweeen bug fixing, new features development, some optimizations, maintaining the code and version upgrade, I want to avoid the upgrade to potentially stop me from my regular work flow.\nIf the upgrade went wrong, I can still fix bug and ship new features of my app to App/Play stores on the main project.\n\n##### 4.2 Use React Native upgrade helper\n\n[React Native upgrade helper](https://react-native-community.github.io/upgrade-helper/)\n\nCheck for code changes before applying it in the project.\n\nOptionally, you can upgrade with `npx react-native upgrade`.\n\nHowever, from the memory of the time I last used it, I don't have a good experience using that.\nI have to resolved conflicts and the worst part was changes on iOS `project.pbxproj` files which is a pain.\n\nEver since then I use upgrade helper and hand-picked the code and manually apply it to my existing project.\nI am happy with that and is aware and consious of what I've changes, so I know where to look for if anything went wrong.\n\nIf my case, upgrading to `0.62.2` only need to change 15 files, which is faster to do hand-picked. (Imagine the time spent on fixing conflicts could be more than that)\n\nPlus, I can exclude the implementation of `flipper` which is a debugging tool included in future versions of `react-native`.\n\nHand picking the lines makes me aware of the additional stuffs that are added (in this case, `flipper`), and I am not including it this time.\n\nReason for doing so is to not have some extra dependencies or code to fix.\n\nI just want to focus on the upgrade and I can live without the debug tool for now.\n\nSince coming from `0.59.10`, I am using my other debugging tool, might as well not introduce uncertainties that will break the product.\n\nI will give `flipper` a try afterwards, but for now, the upgrade is in highest priority.\n\nAfter applying the code changes (or if your are using the upgrade command). Run `yarn install` (or `npm install` depending on your setup.)\n\n##### 4.3 Get your project up and running\n\nAfter installing the versions, if there are no errors. You are good to go to start build and run the project.\n\nAssuming the new packages have no issues, you need to fix the build issues with you app and get it up and running like before.\n\nThe following are the issues that I've encountered and the solution to it.\nI always start debugging with iOS build with xcode. (Just a preference)\n\n1. Run `pod install` and bump into `- ERROR | attributes: Missing required attribute `homepage`.`\n\nSince `0.60.0`, native libraries are now auto linked. That means you don't have to specify the pod in your `Podfile` anymore and React Native will pick that up. (some changes to `Podfile` requires)\nAnd for this reason, native libraries are required to have a `.podspec` file for that to work.\nIf the `homepage` are set to empty string `s.homepage = ''` you will get this issue.\n\nI am getting this issue for this package `https://github.com/Aminoid/react-native-activity-recognition`\n\nThe fix: Fork the repository and add a homepage to it. (There are another issue with this library's podspec, so forking the library is a better choice, more about this later)\n\n2. `CocoaPods could not find compatible versions for pod \"React/Core\":`\n\nThis is a issue with `react-native-image-crop-picker` library. Upgrading the library will fix it.\nSince the dependency is now `React-Core`.\n\n3. `YOUR_PROJECT_PATH/node_modules/react-native/React/Modules/RCTEventEmitter.h:8:9: 'React/RCTBridge.h' file not found`\n\nGot this issue for `react-native-audio-recorder-player`. As you can tell, upgrading the library will fix it.\n\n4. `'React/RCTDefines.h' file not found`\n\nThis one has to do with `AppCenter` packages.\n\nAnd the fix for this is well documented [here](https://docs.microsoft.com/en-us/appcenter/sdk/troubleshooting/react-native).\n\n5. `\u003cReact/RCTBridgeModule.h\u003e file not found`\n\nNow this is the real tricky part.\n\nAt this point, the header file is missing, and we are not sure, whether it is an error that only happens to this library only or all other libraries.\nFor this, there is a way to inspect the issue.\n\nThis is very well written in this Github comment, so I am not going to elaborate futher.\n\nhttps://github.com/facebook/react-native/issues/26665#issuecomment-571082076\n\nIn short, I have to remove the `target.remove_from_project` from `Podfile` `post_install`\n\nthen\n\n```\npod deintegrate\npod cache clean\npod install\n```\n\n(not enough with just removing the `Pods` directory)\n\nand add the missing react back to scheme \u003e build (for all the targets!)\n\n6. Remove from `Libraries` folder in xcode, all the `.xcodeproj` and all the `xxx.a` from `Build Phases \u003e Link Binary with Libraries` from native libraries if you haven't.\n\nOr use `react-native unlink` (but again, I do it manually from xcode, because I don't want to unlink for android yet, as it turns out, android works without unlinking, but is is now redundant.)\n\nOtherwise app will have duplicated headers from Pods and the Libraries projects.\n\n7. `MKTouchableManager.m:11:9: error: 'UIView+React.h' file not found with \u003cangled\u003e include; use \"quotes\" instead`\n\nThen I am having this issue with `react-native-material-kit`. I use this for ranged slider with two thumbs. Looking for alternatives, but I am fixing this one first.\n\nTurns out upgrading the project to the latest version fixed the issue.\n\n8. `No known class method for selector 'configure'`\n\nThen this issue, from firebase, basically I need to use firebase v6 instead of v5. Well, another breaking changes.\nSince local push notification are no longer usable in v6. I need to find solution for that. So in this case, upgrade to v6,\nand comment out implementation for local push notification and come back to this later.\n(Remember, we want to build and run the app and not spending too much time replacing the implementation and then we don't know why it is not working. Do one thing at a time. Complete the upgrade first.)\n\nUpgrading to v6 has no much issues, also because the only thing that was in used with firebase is the local push notification. (but there are plans to use the Crashlytics, part of the reason why the upgrade is done)\nAnd of course, the documentation on the website is great. I am using `react-native-firebase`. (Sometimes the documentation update is so frequent that old documentation is not there anymore, so just keep up to date with the latest version as best as you can.)\n\n---\n\nAt this point, the app can be built and run on simulator already.\n\n---\n\n9. `Invariant Violation: Native module cannot be null.` and `'React/RCTEventEmitter.h' file not found`\n\nThis is from the `react-native-activity-recognition` library I am using. Second issue from the same library.\nAnd it has to do with a incorrect path in `podspec` being used. Before this I fixed it with importing the project to library and manually link the library code.\nBut now I need to use Podfile and this has to be fixed with updating the `podspec` of the library.\n\nSolution: Fork the repository, update the `podspec` and install it in your app.\n\n10. `null is not an object (evaluating '_ReanimatedModule.default.createNode')`\n\nThis has to do with `react-native-tab-view`. Upgrade the `react-native-tab-view` and `react-native-reanimated` to the latest version.\nRun `pod install` for `react-native-reanimated` to be updated.\n\n11. `Undefined is not an object (evaluating 'navigator.geolocation.getCurrentPosition')`\n\n`navigator` is no longer available from the global object.\nInstall and use the it from `https://github.com/react-native-community/react-native-geolocation` instead.\n\n12. Also deprecated APIs are: `ViewPager` and `ListView`\n\nIf you are using libraries that depends on these APIs, you will need to upgrade the library as well. Or replace/remove the APIs in your app.\n\n13. `Cannot read property measureInWindow of undefined`\n\nIssue with `react-navigation` v3. You will need to use v4 or v5.\n\nFrom v3 to v4 has some minor changes. From v3 or v4 to v5 will have API changes. So upgrade with care.\n\nFor me, I opt to upgrade to v4 and still have some unexpected changes in behaviour. And need to fix it.\n\nAs you know, the local push notification is now broken, so I want to just stay with v4 to have less code that broken.\n\nAnd when the app are back up to where, then I will consider upgrading to v5.\n\n14. `TypeError: Cannot call a class a function`\n\nThis is a changes in the code that I wrote, it is now illegal to do that, I haven't investigated further whether the changes is from `react-navigation` or `react` library.\nBut I managed to figured out the issue.\n\nCode with issue: (works with `0.59.10`)\n\n```\nheaderLeft: NavHeader.Back,\n```\n\nCode changes after the upgrade:\n\n```\nheaderLeft: props =\u003e \u003cNavHeader.Back {...props} /\u003e\n```\n\nYou should be able to tell what's wrong from the error description. (`NavHeader` is a class component)\n\n15. Issue with PagerPan from `react-native-tab-view`\n\nCode with issue:\n\n```\nimport { TabView, SceneMap, PagerPan } from 'react-native-tab-view';\n```\n\nCode changes:\n\n```\nimport { TabView, SceneMap, ScrollPager as PagerPan } from 'react-native-tab-view';\n```\n\nHowever, even after the fix, the behaviour is not the same, therefore more work has to be done to disable animation and swipe on the tab.\n\n\n16. `AirGoogleMaps` dir must be added to your xCode project to support GoogleMaps on iOS.\n\nUpgrade the library and make sure to run `pod install`\n\n##### End\n\nHopefully my writing can help you with the upgrade. Happy coding.\n\nI will be writing up with the upgraded project next.\n\n\u003cbr /\u003e\n\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2020/04/27-upgrade-rn/index.md","timeToRead":12},{"slug":"reduce-your-react-native-android-app-size","frontmatter":{"path":"/blog/reduce-your-react-native-android-app-size","date":"2020-07-19T13:11:00.962Z","title":"Reduce your react-native android app size","excerpt":"By 55% with android app bundle (.aab)","tags":["react-native"]},"content":"\nOne of the many things that bother me after my React Native app went public is the app size.\n\nBig app size is not a show stopper to continue adding new features to my app, nor it causes anything bad.\n\nSo, it has always been the least priority to work on that.\n\nSome say it costs a bit of performance, if the app size is too big.\n\nHowever, it isn't really critical for any newly launched app for a premature optimization, on the app size.\n\nI've always wanted to fix it (when I have the time), and I think now is the best time, because I can do it for\n\nmultiple projects that I am juggling, with the same optimization trick.\n\nAnd, it's really simple.\n\nNOTE: This is an Android only optimization.\n\n###### Before\n\n![before](before.png)\n\n\u003cbr /\u003e\n\n###### After\n\n![after](after.png)\n\n\u003cbr /\u003e\n\nYou can do it with any *ONE* of two ways below:\n\n#### 1. Android app bundle\n\nSimply change your build process from\n\n`./gradlew assembleRelease`\n\nto\n\n`./gradlew bundleRelease`\n\nThe output will be `.aab` file instead of `.apk` file.\n\nNote that the `.aab` file will not have any significant file size changes compared to the `.apk` file.\n\nThe reduction in size will only be visible after uploaded the `.aab` file to Play Store.\n\n\u003cbr /\u003e\n\n#### 2. Separate Build by CPU Architecture\n\nIn your project's `android/app/build.gradle` file.\n\nUpdate the following setting.\n\n`def enableSeparateBuildPerCPUArchitecture = true`\n\n```\nsplits {\n    abi {\n        ...\n        enable enableSeparateBuildPerCPUArchitecture // be sure to enable here as well\n        ...\n    }\n}\n```\n\nContinue to build the apk as usual.\n\nThe output will be multiple `.apk` files (usually 4).\n\nEach of the `.apk` file will have significant reduction in app size.\n\nUpload all of them to the Play Store for submission.\n\nWorth to note that, the universal '.apk' file will not be built.\n\n(The one that support all architecture, thus the heavy size.)\n\nIf you want it to be in the output apk, along with the others, change the following setting.\n\n```\nsplits {\n    abi {\n        ...\n        enable enableSeparateBuildPerCPUArchitecture\n        universalApk true  // If true, also generate a universal APK\n        ...\n    }\n}\n```\n\nThen you will have 5 `.apk` files in the output folder.\n\nRead about why enabling the `universalApk` below.\n\n\u003cbr /\u003e\n\n---\n\n\u003cbr /\u003e\n\n#### Which one to use\n\nFor most of us, switching to use Android App Bundle (aab) is painless.\n\nThus, recommended to use it.\n\nHowever, here's are some of the things to consider.\n\n\u003cbr /\u003e\n\n##### 1. Firebase App Distribution does not support (.aab) at the moment.\n\nIf you use Firebase for internal distribution, you might want to use `Separate Build by CPU Architecture` approach, together with `universalApk` enabled.\n\nWhat you can do is, use universal apk file for distribution, and the separated `.apk` files for Play Store submission.\n\nSo, what about if you are using `.aab` file? How can you distribute the app for internal testing?\n\nWell, if there are no existing tools that are already integrated into the app, and need to cater for it,\nthen you might want to consider using Play Store's distribution track.\n\nYou can setup automated process to upload the `.aab` file after building it to the Play Store track.\n\nThis require owner access though.\n\n\u003cbr /\u003e\n\n##### 2. The reduction in size for both approaches are almost identical.\n\nFrom what I can tell, after experimenting with both approaches, and using both ways for different apps, in production.\n\nThe size reduction benefit is almost identical. In both cases, I got more than 50% in size reduction.\n\nSo the size reduction is not much of a deciding factor. Which makes us move to the next point.\n\n\u003cbr /\u003e\n\n##### 3. Concern on Android App Bundle's capabilities.\n\nFor most of the app out there, App Bundle offer hassle-free switch.\n\nWhile some of the use cases, it might be more complicated to maintain.\n\nIf you are not sure, refer to official documentation of Android development.\n\nIf you are not convinced, your app doesn't have defined scope and complexity, or your app might\ngrow to eventually having very complicated/advanced use cases, you can stick to separated '.apk' approach.\n\nOtherwise, using `.aab` is recommended.\n\nWell this post is not going to elaborate the differences of '.apk' and '.aab', but it is worth doing your research about the topic.\n\n\u003cbr /\u003e\n\n---\n\n\u003cbr /\u003e\n\n#### Conclusion\n\nWith that said, you will have your Android app with very much reduced size by now!\n\nFor my apps, over 50% in reduction.\n\nCheers!\n\nand\n\nHappy coding!\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2020/07/19-android-bundle/index.md","timeToRead":4},{"slug":"android-accessing-cached-image-dir","frontmatter":{"path":"/blog/android-accessing-cached-image-dir","date":"2020-07-26T12:49:00.962Z","title":"Access to android files in cache directory","excerpt":"Using adb cli","tags":["react-native","android"]},"content":"\nYou take a picture from your app, and get back an uri in return.\n\nThen you proceed to upload the photo to server. End of story.\n\nAs a developer, you know that's not always the case, sometimes it's a bit more complicated, you take a snapshot from within the app,\nand realized that it returns black image.\n\nSo you want to debug, and without uploading to server, you can't access to the file,\nto take a look at the state of the image, whether your code changes has fixed the issue or not.\n\nOr you want to manipulate the image before uploading.\n\nFor whatever reason, you want to access to the file in cache.\n\nAfter few failed attempts to get it via tools like `Android File Transfer` and others\nthat can access to the Android file system.\n\nI found the solution with `adb` cli, and here is how to do it, from your Android device.\n\n\n```\nadb shell \"run-as com.yourapp.bundle cat '/data/user/0/com.yourapp.bundle/cache/ReactNative-image1215816883788.jpg' \u003e '/sdcard/DCIM/ReactNative-image1215816883788.jpg'\"\n\nadb pull \"/sdcard/DCIM/ReactNative-image1215816883788.jpg\"\n\n```\n\nThat's it!\n\nNow, check your current directory for the file `ReactNative-image1215816883788.jpg`\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2020/07/26-android-access-to-cached-image-dir/index.md","timeToRead":1},{"slug":"layout-animation-in-a-nutshell","frontmatter":{"path":"/blog/layout-animation-in-a-nutshell","date":"2021-01-14T21:50:00.000Z","title":"LayoutAnimation in a nutshell","excerpt":"Simple and powerfull, even for complicated layouts","tags":["react-native"]},"content":"\nUsing `Animated` to animate components in `react-native` has been the my go to way of doing things for the past few years.\n\nUntil recently when I discovered that `LayoutAnimation` can achieve similar result in animating component without the hassle of managing the states of the animation.\n\nIn this case, I am trying to animate the `TextInput` of a chat screen, to expand and collapse accordingly when the input starts receiving text, or when it's been cleared.\n\n\u003c!-- Below is the comparison: --\u003e\n\n\u003c!-- \u003cimg src=\"./layoutAnimation-before.gif\" width=\"384\" height=\"868\"/\u003e\n\u003cimg src=\"./layoutAnimation-after.gif\" width=\"384\" height=\"868\"/\u003e --\u003e\n\nAll I did was adding this magical line before setting the `props/state` that responsible for expanding or collapsing the view.\n\n```\nLayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut);\n```\n\nThis also works great with views with accordions and toggles.\n\nIt is possible to get it work with `Animated` but now that this is way much simpler, I think its worth sharing.\n\nFor more of the detail of using it, check out the official documentation for `LayoutAnimation`.\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2021/01/14-layout-animation-in-a-nutshell/index.md","timeToRead":1},{"slug":"react-native-listen-to-port-other-than-8081","frontmatter":{"path":"/blog/react-native-listen-to-port-other-than-8081","date":"2022-01-17T15:33:00.000Z","title":"React Native Listen to Port Other Than 8081","excerpt":"A different approach using RCT_METRO_PORT","tags":["react-native"]},"content":"\nAfter trying out different solutions attempted to listen to different port other than 8081 for react-native metro bundler.\nFinally I have managed to achieve this **WITHOUT** the hassle of editing files such as:\n\n```\nRCTBridgeDelegate.h\nRTCDefines.h\nRCTInspectorDevServerHelper.m\nRCTDevMenu.m\n```\n\nWhile this approach works, the issue with it is the changes get reset after running `pod install`.\n\nSo after reading alot materials, with some improvisation, I came up with the solution using `Podfile`.\n\n\u003cbr /\u003e\n\n#### Podfile\n\n```\npost_install do |installer|\n  react_native_post_install(installer)\n  __apply_Xcode_12_5_M1_post_install_workaround(installer)\n\n  installer.pods_project.targets.each do |target|\n    if target.name == 'React-Core'\n      target.build_configurations.each do |config|\n        if config.name == 'Debug'\n          config.build_settings['GCC_PREPROCESSOR_DEFINITIONS'] ||= ['$(inherited)']\n          config.build_settings['GCC_PREPROCESSOR_DEFINITIONS'] = config.build_settings['GCC_PREPROCESSOR_DEFINITIONS'] + ['RCT_METRO_PORT=8089']\n        end\n      end\n    end\n  end\nend\n```\n\n\u003cbr /\u003e\n\n#### Metro server\n\n`npx react-native start --port=8089`\n\n\u003cbr /\u003e\n\nThat's it! Now, run `pod install` and run the app and it will be listening to port `8089`.\n\nFor Android, change the dev server setting from your device and it is reload the app. This part will not be covered in this article because there are alot of online resources that works perfectly.\n\nHope it helps.\n\nCheers.","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2022/01/17-react-native-metro-port/index.md","timeToRead":1},{"slug":"ios-shared-userdefaults-for-app-extensions-with-rctbridgemodule","frontmatter":{"path":"/blog/ios-shared-userdefaults-for-app-extensions-with-rctbridgemodule","date":"2022-01-20T15:37:00.000Z","title":"iOS Shared UserDefaults for App Extensions With RCTBridgeModule","excerpt":"Get/Set key-value from both React Native and Swift/Obj-C","tags":["react-native","ios"]},"content":"\nIn this blog post, I will share the code for a simple RCTBridgeModule that can write/read key-value from React Native.\n\nThe use case for this is to access the data in iOS Share Extension using value set from React Native.\n\nSo that the Share Extension can perform API call with sufficient data that was set in React Native, and thus giving user a much better experience similar to other natively built apps. This is a much more complicated implementation and there are much simpler ways to get it done without writing too many native code and that will be for another blog post.\n\nLet's get back and focus on this topic, get and set value in `UserDefaults` that are accesible in Share Extension.\nIn order to achieve that, we need to use `UserDefaults` with `suiteName` that starts with `group.`.\n\nBefore you proceed, please make sure that you have already created Share Extension and updated `App Groups` in the `Signing \u0026 Capabilities`.\nThis is not covered in this post and there are alot of online resources for this topic.\n\n\u003chr /\u003e\n\n\u003cbr /\u003e\n\n##### 1. First, create a header file in xcode.\n\nI'll name it `SharedUserDefaults.h`\n\n```\n#ifndef SharedUserDefaults_h\n#define SharedUserDefaults_h\n#endif\n\n#import \u003cFoundation/Foundation.h\u003e\n\n#if __has_include(\u003cReact/RCTAssert.h\u003e)\n#import \u003cReact/RCTBridgeModule.h\u003e\n#else\n#import \"RCTBridgeModule.h\"\n#endif\n\n@interface SharedUserDefaults : NSObject \u003cRCTBridgeModule\u003e\n@end\n```\n\n\u003cbr /\u003e\n\n##### 2. Then, create the implementation file.\n\n`SharedUserDefaults.m`\n\n```\n#import \u003cFoundation/Foundation.h\u003e\n#import \"SharedUserDefaults.h\"\n\n@implementation SharedUserDefaults\n\nRCT_EXPORT_MODULE()\n\n+ (BOOL)requiresMainQueueSetup\n{\n  return YES;\n}\n\nRCT_EXPORT_METHOD(set:(NSString *)suiteName\n                  key:(NSString *)keyName\n                  value:(NSString *)value)\n{\n  NSUserDefaults *shareExtensionDefaults = [[NSUserDefaults alloc] initWithSuiteName: suiteName];\n  [shareExtensionDefaults setObject:value forKey:keyName];\n  NSLog(@\"val written %@\", value);\n}\n\nRCT_EXPORT_METHOD(get:(NSString *)suiteName\n                  key:(NSString *)keyName\n                  resolver: (RCTPromiseResolveBlock)resolve\n                  rejecter:(RCTPromiseRejectBlock)reject)\n{\n  NSUserDefaults *shareExtensionDefaults = [[NSUserDefaults alloc] initWithSuiteName: suiteName];\n  NSString *val = [shareExtensionDefaults stringForKey:keyName];\n  if (val == nil) {\n    NSError *error = [NSError errorWithDomain:@\"org.reactjs.native.example.Bill\" code:0 userInfo:@{ @\"message\": @\"Empty\" }];\n    reject(@\"error\", @\"error description\", error);\n  } else {\n    resolve(val);\n  }\n}\n\n@end\n```\n\n\u003cbr /\u003e\n\n##### 3. Next, build and run your app.\n\nAnd you can use the methods from the native module you've just written.\n\nIn your React Native project, you can now get and set key-value pair to UserDefaults via the native module.\n\n```\nimport { NativeModules } from 'react-native';\n\nconst SharedUserDefaults = NativeModules.SharedUserDefaults;\n\n// Usage\n\n// Set\nSharedUserDefaults.set(\"group.org.reactjs.native.example.YourProject\", \"yourKey\", \"some string to be stored\");\n\n// Get\nlet val = await SharedUserDefaults.get(\"group.org.reactjs.native.example.YourProject\", \"yourKey\");\n```\n\nIn iOS, the value can be retrieved in `ShareViewController.swift` or `AppDelegate.m`.\n\n`Swift`\n\n```\nvar userDefaults = UserDefaults(suiteName: \"group.org.reactjs.native.example.YourProject\")\n\n// Get value stored earlier\nlet storedValue = userDefaults?.object(forKey: \"yourKey\") as? String\n\n // Set new value\nuserDefaults?.set(\"some string to be stored\", forKey: \"yourKey\")\n```\n\n`Obj-C`\n\n```\n  NSUserDefaults *userDefaults = [[NSUserDefaults alloc] initWithSuiteName: @\"group.org.reactjs.native.example.YourProject\"];\n\n  // Get value stored earlier\n  NSString *val = [userDefaults stringForKey:@\"yourKey\"];\n\n  // Set new value\n  [userDefaults setObject:@\"some string to be stored\" forKey:@\"yourKey\"];\n```\n\n\u003cbr /\u003e\n\n#### End\n\nYou are now all set!\n\nNow you can set value from React Native and retrieve it in your `ShareViewController.swift`.\n\nThat's it! Hope it helps.\n\nCheers.","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2022/01/20-shared-users-default/index.md","timeToRead":2},{"slug":"remove-unused-and-reorder-imports","frontmatter":{"path":"/blog/remove-unused-and-reorder-imports","date":"2022-01-21T15:08:00.000Z","title":"Remove unused and reorder imports","excerpt":"With ESLint and VS Code","tags":["react-native","typescript"]},"content":"\nToday, I revisited the react-native project that was developed and published by me earlier and the first thing I did was to run tests because I intended to add more Typescript support to the project, wanted to know the current state of test suites of the project.\n\nIt wasn't the best FIRST task as a start, but in my opinion, adding more Typescript will be benefiting over the long run.\n\nI've identified removing unused imports to be the low hanging fruit to fix the `tsc` errors.\n\nI started with [https://www.npmjs.com/package/eslint-plugin-unused-imports](https://www.npmjs.com/package/eslint-plugin-unused-imports) but turned out it also removes custom Types import that was used in my files.\n\nThen I found out that VS Code can achieve that with organize import feature.\n\n```\n\"editor.formatOnSave\": true,\n\"[typescript]\": {\n    \"editor.codeActionsOnSave\": {\n        \"source.organizeImports\": true\n    }\n}\n```\n\nThat works also with `Shift` + `Option` + `o` shortcut. However, that will also reorder the imports alphabetically.\nIt seems like there is no way to only remove unused imports without reorder them with `organizeImports`, that being one issue.\nThe second issue is that I need to also press the shortcut keys for every files. Which is very repetitive work, because there are 1105 files in my `/src` directory.\n\n```\n$ find src -type f | wc -l\n  1105\n```\n\nThe second issue was resolved with a VS Code extension to run `organizeImports` in a folder.\n\n[https://marketplace.visualstudio.com/items?itemName=bierner.folder-source-actions](https://marketplace.visualstudio.com/items?itemName=bierner.folder-source-actions)\n\nThen to reorder the imports to my desired orders, I found this great article [https://dev.to/otamnitram/sorting-your-imports-correctly-in-react-213m](https://dev.to/otamnitram/sorting-your-imports-correctly-in-react-213m) that does that.\n\nThis is my config\n\n```\n\"import/order\": [\n  \"error\",\n  {\n    \"groups\": [ \"builtin\", \"external\", \"internal\", [\"parent\", \"sibling\"] ],\n    \"pathGroups\": [\n      {\n        \"pattern\": \"react+(|-*)\",\n        \"group\": \"external\",\n        \"position\": \"before\"\n      },\n      {\n        \"pattern\": \"@**+(/**)\",\n        \"group\": \"internal\",\n        \"position\": \"before\"\n      }\n    ],\n    \"pathGroupsExcludedImportTypes\": [\"react\"],\n    \"newlines-between\": \"always\",\n    \"alphabetize\": {\n      \"order\": \"asc\",\n      \"caseInsensitive\": true\n    }\n  }\n],\n```\n\nJust a TIL from me. That's it! Hope it helps.\n\nCheers.\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2022/01/21-remove-unused-and-reorder-imports/index.md","timeToRead":2},{"slug":"another-react-native-project-upgrade","frontmatter":{"path":"/blog/another-react-native-project-upgrade","date":"2022-02-08T22:02:00.000Z","title":"Another react-native project upgrade","excerpt":"To 0.66.4","tags":["react-native"]},"content":"\nWhile the latest released version for `react-native` is `0.67.2`, I upgraded the project that I am working on to `0.66.4` instead.\n\nThis is mainly due to some issues that I ran into that I decided not to spend too much time fixing it since `0.66.4` is sufficient for my use case.\n\nIn this blog, I will be sharing some of the issues that I ran into and the solutions for them. Hopefully someone might find it useful, and I can also refer to this blog in the near future if I need to upgrade other projects.\n\n\u003cbr /\u003e\n\n#### The issues\n\n1. folly\n\n```\n\nduplicate symbol 'folly::detail::str_to_bool(folly::Range\u003cchar const*\u003e*)' in:\n...\n...\n```\n\nIn my case, I need to do\n\n```\npod update\npod install\n```\n\nNormally you need to run `pod update` after update `react-native` version\n\nor in some cases\n\n```\nrm -rf Podfile.lock Pods/\npod install\n```\n\nif you thing you have messed up the `Pods` after upgrading to different `react-native` versions back and forth.\n\n2. `#\u003cWeakSet\u003e could not be cloned`\n\nThen you might get this issue for any library.\n\n```\nerror node_modules/react-native-vector-icons/lib/create-icon-set.js: #\u003cWeakSet\u003e could not be cloned.\n\nerror: node_modules/react-native-branch/src/branchUniversalObject.js: function (path) {\n          return fn.call(state, path, state);\n        } could not be cloned.\n BUNDLE  ./index.js\n ```\n\nThis has to do with `babel`, so you need to upgrade them as well.\n\n```\nyarn upgrade --dev @babel/core\nyarn upgrade --dev @babel/runtime\n```\n\n3. Android project could not resolve dependencies\n\nError:\n\n```\n\nFAILURE: Build failed with an exception.\n\n* What went wrong:\nCould not determine the dependencies of task ':app:lintVitalBetaRelease'.\n\u003e Could not resolve all artifacts for configuration ':app:betaDebugRuntimeClasspath'.\n   \u003e Could not resolve me.relex:photodraweeview:1.1.3.\n     Required by:\n         project :app \u003e project :react-native-photo-view-ex\n      \u003e Skipped due to earlier error\n   \u003e Could not resolve org.webrtc:google-webrtc:1.0.+.\n     Required by:\n         project :app \u003e project :react-native-twilio-video-webrtc\n      \u003e Skipped due to earlier error\n   \u003e Could not resolve com.yqritc:android-scalablevideoview:1.0.4.\n     Required by:\n         project :app \u003e project :react-native-video\n      \u003e Skipped due to earlier error\n   \u003e Could not resolve com.getkeepsafe.relinker:relinker:1.3.1.\n     Required by:\n         project :app \u003e project :react-native-twilio-video-webrtc \u003e com.twilio:video-android:5.10.0\n      \u003e Skipped due to earlier error\n```\n\nAnother error:\n```\nCould not determine the dependencies of task ':app:lintVitalRelease'.\n\u003e Could not resolve all artifacts for configuration ':app:debugRuntimeClasspath'.\n   \u003e Could not find com.yqritc:android-scalablevideoview:1.0.4.\n     Searched in the following locations:\n       - https://repo.maven.apache.org/maven2/com/yqritc/android-scalablevideoview/1.0.4/android-scalablevideoview-1.0.4.pom\n\n```\n\nThis is due to removal of the line `jcenter()` in `android/build.gradle`. Moving forward, JCenter will not be maintained.\n\nSo it is recommended to remove the depencencies to the repository.\n\n[Read more about the announcement here.](https://reactnative.dev/blog/2021/08/17/version-065#notable-dependency-version-updates-and-gotchas)\n\nAt the meantime, we have libraries that depends on JCenter and it's going to take time for maintainers to update the libraries.\n\nSo we can do this for now for the dependencies we need.\n\n```\n        jcenter() {\n            content {\n                includeModule(\"me.relex\", \"photodraweeview\") // Could not resolve me.relex:photodraweeview:1.1.3.\n                includeModule(\"org.webrtc\", \"google-webrtc\") // Could not resolve org.webrtc:google-webrtc:1.0.+.\n                includeModule(\"com.yqritc\", \"android-scalablevideoview\") // Could not resolve com.yqritc:android-scalablevideoview:1.0.4.\n                includeModule(\"com.getkeepsafe.relinker\", \"relinker\") // Could not resolve com.getkeepsafe.relinker:relinker:1.3.1.\n            }\n        }\n```\n\nSo now you get the idea of using `includeModule`.\n\nThat's all for the issues.\n\nHope that saves your precious time!\n\nCheers.","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2022/02/08-upgrade-react-native/index.md","timeToRead":3},{"slug":"react-native-project-upgrade-march-2023","frontmatter":{"path":"/blog/react-native-project-upgrade-march-2023","date":"2023-03-24T15:26:00.000Z","title":"react-native project upgrade","excerpt":"To 0.70.6","tags":["react-native"]},"content":"\nI upgraded react-native for an app I'm working on to `0.70.6`.\n\nNew architecture was being introduced however I am turning that off for now until I figured out the benefits of it.\n\nWith that said, it is still exciting to build mobile apps with React Native, and even so with the new architecture.\n\nMost of the issues that I am facing when upgrading the app were able to be fixed with just simply upgrading the corresponding packages/dependencies to the latest version.\n\nWhile some other have alternatives like using temporary packages to fix the error. For example, using `deprecated-react-native-prop-types` to replace legacy code `ViewPropTypes` and `Text.PropTypes` in the project.\n\n\u003cbr /\u003e\n\nFor android, a lot of issues thrown out when building the app (as usual), but are able to be solved after spending some time. For example, in the following error, use `allowInsecureProtocol = true` for one of the repository (though it will be better to inspect the usage of this package in the near future, and revisit this workaround).\n\n```\n* What went wrong:\nCould not determine the dependencies of task ':app:lintVitalReportBetaRelease'.\n\u003e Could not resolve all dependencies for configuration ':app:betaReleaseRuntimeClasspath'.\n   \u003e Using insecure protocols with repositories, without explicit opt-in, is unsupported. Switch Maven repository 'maven6(http://dl.bintray.com/lukaville/maven)' to redirect to a secure protocol (like HTTPS) or allow insecure protocols. See https://docs.gradle.org/7.5.1/dsl/org.gradle.api.artifacts.repositories.UrlArtifactRepository.html#org.gradle.api.artifacts.repositories.UrlArtifactRepository:allowInsecureProtocol for more details.\n\n```\n\n\u003cbr /\u003e\n\nSolutions for other issues are not available, therefore I change the code in the packages and use `patch-package` for that. Not that I am satisfied with it, but it is the way to go for now.\n\nThat's all. Cheers.\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2023/03/24-react-native-project-upgrade/index.md","timeToRead":2},{"slug":"redux-ducks-pattern","frontmatter":{"path":"/blog/redux-ducks-pattern","date":"2023-06-24T08:40:00.000Z","title":"\"Redux Ducks\" pattern, redux-toolkit, redux-saga and circular dependencies","excerpt":"Adopting tools and pattern","tags":["react-native"]},"content":"\nAdding `redux-toolkit` to my code has reduced the amount of code that needs to be handwritten in my apps.\n\nNot too long ago, I am building a web app for a mobile-first application that I am working on. I realized that I needed a more efficient way to manage my redux code.\nInitially it started with `react-native-web` and it worked out okay that I could port my `react-native` code to my web app, written using `Next.js` and `react.js`.\nWriting a web app with `react-native` components API was certainly not the end goal of the web app, but just a transition to get the momentum going.\nTransitioning to using standard web HTML and React components requires some effort, but it turns out to be more productive in building web app, even more when I used `tailwindcss` to style the components.\n\nNow, when it comes to the state management with redux, I have found a better way to structure the directories (compared to existing ones in my project), using `redux-toolkit`, and `\"Redux ducks\" pattern`.\nPreviously, what needs to be done in 3 files for an action and side effects (1 file for action types, another for reducers, and another for redux-saga side effects) can now be done in 1 file. That significantly reduced the amount of boilerplate code, and fewer mistakes when\nwriting those files.\n\nJust be aware of the potential downside of using the ducks pattern, which is potential circular dependencies in the code, which may lead to undefined imports.\nThe solution highlighted in [this blog post](https://medium.com/visual-development/how-to-fix-nasty-circular-dependency-issues-once-and-for-all-in-javascript-typescript-a04c987cf0de) is elegant and makes sense.\n\nIn the future, I hope there is enough time to put the web and mobile apps codebase under a monorepo.\n\nThat's all. Cheers.\n","fullPath":"/Users/chinloong/makespace/chinloongtan-web/src/content/blog/2023/06/24-redux-ducks-pattern/index.md","timeToRead":2}],"totalCount":10,"tag":"react-native"},"__N_SSG":true},"page":"/tags/[tag]","query":{"tag":"react-native"},"buildId":"9TO4ALtp1qxTSA0DNeSWz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>